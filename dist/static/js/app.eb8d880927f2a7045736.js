webpackJsonp([1],{"+c8h":function(t,e){},"0VZb":function(t,e){},"2mV7":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("gNcp"),r={};n.keys().forEach(function(t){"./index.js"!==t&&(r[t.replace(/(\.\/|\.js)/g,"")]=n(t).default)}),e.default=r},EVg2:function(t,e){},Fw1l:function(t,e){},H2hR:function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});a("j1ja");var n=a("7+uW"),r={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("keep-alive",[this.$route.meta.keepAlive?e("router-view"):this._e()],1),this._v(" "),this.$route.meta.keepAlive?this._e():e("router-view")],1)},staticRenderFns:[]};var i=a("VU/8")({name:"App"},r,!1,function(t){a("oWsi")},null,null).exports,s=a("/ocq"),o=a("Xxa5"),c=a.n(o),l=a("exGp"),u=a.n(l),d=a("mtWM"),p=a.n(d),f="http://manage.sharezdm.cn/",h="http://101.132.175.224:5000/difftech/api/v0.1/";function m(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20;return p()({url:f+"photo/photo_list",method:"get",params:{page_num:e,page_size:a,is_label:t},withCredentials:!0})}function v(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20;return p()({url:f+"photo/list",method:"get",params:{page_num:e,page_size:a,manual_label:t},withCredentials:!0})}function g(){return p()({url:f+"feature/list",method:"get",withCredentials:!0})}function _(t){return p()({url:f+"feature/feature_answer",method:"delete",data:{id:t},withCredentials:!0})}function b(t){return p()({url:f+"feature/addphotofeature",method:"post",data:t,withCredentials:!0})}function w(t){return p()({url:"http://diff.sharezdm.cn/index/analyzefacepro",method:"post",data:{image_url:t}})}function x(){return p()({url:"http://diff.sharezdm.cn/index/getuploadtoken",method:"get",withCredentials:!0})}function y(t){return p()({url:h+"features/"+t,method:"get",withCredentials:!0})}function k(t,e,a){return p()({url:h+"features/submit",method:"post",data:{img_id:t,feature_id:e,info:a},withCredentials:!0})}function C(t){return p()({url:h+"features/stats/"+t,method:"get",withCredentials:!0})}function U(t){return p()({url:h+"features/listimg/"+t,method:"get",withCredentials:!0})}function F(t){return p()({url:h+"features/imginfo/"+t,method:"get",withCredentials:!0})}function $(t,e){return p()({url:h+"features/discard",method:"post",data:{img_id:t,feature_id:e},withCredentials:!0})}function I(t){return-1!=t.indexOf("http")?t+"?imageView2/2/w/1024/h/1024":"http://pc43w2wc6.bkt.clouddn.com/"+t}var S={name:"Index",data:function(){return{activeName:"first",labelData:[],notLabelData:[],labelTotal:20,notLabelTotal:20,qiniuUrl:I}},mounted:function(){this.init()},methods:{init:function(){var t=this;return u()(c.a.mark(function e(){var a,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m();case 2:return a=e.sent,t.labelData=a.data.data.rows,t.labelTotal=a.data.data.count,e.next=7,m(1);case 7:n=e.sent,t.notLabelData=n.data.data.rows,t.notLabelTotal=n.data.data.count;case 10:case"end":return e.stop()}},e,t)}))()},labelCurrentChange:function(t){var e=this;return u()(c.a.mark(function a(){var n;return c.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,m(0,t,20);case 2:n=a.sent,e.labelData=n.data.data.rows,e.labelTotal=n.data.data.count;case 5:case"end":return a.stop()}},a,e)}))()},notLabelCurrentChange:function(t){var e=this;return u()(c.a.mark(function a(){var n;return c.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,m(1,t,20);case 2:n=a.sent,e.notLabelData=n.data.data.rows,e.notLabelTotal=n.data.data.count;case 5:case"end":return a.stop()}},a,e)}))()},labelClick:function(t){console.log(t),this.$router.push({path:"/pc/label",query:{id:t.id,user_id:t.user_id,file_url:t.file_url}})},updateLabelClick:function(t){console.log(t),this.$router.push({path:"/pc/update_label",query:{id:t.id,user_id:t.user_id,file_url:t.file_url}})}}},D={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"未标注照片",name:"first"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:t.labelData}},[a("el-table-column",{attrs:{label:"照片",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{style:{backgroundImage:"url("+t.qiniuUrl(e.row.file_url)+")",backgroundSize:"cover",width:"75px",height:"75px"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"id",label:"照片id",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"created_at",label:"上传时间",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.labelClick(e.row)}}},[t._v("标注")])]}}])})],1),t._v(" "),a("el-pagination",{attrs:{background:"","page-size":20,layout:"prev, pager, next",total:t.labelTotal},on:{"current-change":t.labelCurrentChange}})],1),t._v(" "),a("el-tab-pane",{attrs:{label:"已标注照片",name:"second"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:t.notLabelData}},[a("el-table-column",{attrs:{label:"照片",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{style:{backgroundImage:"url("+t.qiniuUrl(e.row.file_url)+")",backgroundSize:"cover",width:"75px",height:"75px"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"id",label:"照片id",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"created_at",label:"上传时间",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.updateLabelClick(e.row)}}},[t._v("更改标注")])]}}])})],1),t._v(" "),a("el-pagination",{attrs:{background:"","page-size":20,layout:"prev, pager, next",total:t.notLabelTotal},on:{"current-change":t.notLabelCurrentChange}})],1)],1)},staticRenderFns:[]};var E=a("VU/8")(S,D,!1,function(t){a("PgRt")},"data-v-11d77764",null).exports,R={data:function(){return{ruleForm2:{account:"",pass:""},rules2:{pass:[{validator:function(t,e,a){""===e?a(new Error("请输入密码")):a()},trigger:"blur"}],account:[{validator:function(t,e,a){""===e?a(new Error("请输入账户")):a()},trigger:"blur"}]}}},methods:{submitForm:function(t){var e=this,a=this;this.$refs[t].validate(function(t){if(!t)return console.log("error submit!!"),!1;var n,r;(n=e.ruleForm2.account,r=e.ruleForm2.pass,p()({url:h+"features/login",method:"post",data:{username:n,password:r},withCredentials:!0})).then(function(t){t.data.code?a.$router.push("/choose"):(e.$message({type:"error",message:t.data.msg}),e.ruleForm2={account:"",pass:""})})})},resetForm:function(t){this.$refs[t].resetFields()}}},z={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wrapper"},[a("div",{staticClass:"login"},[a("el-form",{ref:"ruleForm2",staticClass:"demo-ruleForm",attrs:{"label-position":"left",model:t.ruleForm2,"status-icon":"",rules:t.rules2,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"账户",prop:"account"}},[a("el-input",{model:{value:t.ruleForm2.account,callback:function(e){t.$set(t.ruleForm2,"account",e)},expression:"ruleForm2.account"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"pass"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:t.ruleForm2.pass,callback:function(e){t.$set(t.ruleForm2,"pass",e)},expression:"ruleForm2.pass"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("ruleForm2")}}},[t._v("登录")]),t._v(" "),a("el-button",{on:{click:function(e){t.resetForm("ruleForm2")}}},[t._v("重置")])],1)],1)],1)])},staticRenderFns:[]};var L=a("VU/8")(R,z,!1,function(t){a("vUjk")},"data-v-6b1cdbb9",null).exports,P={data:function(){var t=this;return{ruleForm2:{account:"",pass:"",checkPass:""},rules2:{checkPass:[{validator:function(e,a,n){""===a?n(new Error("请再次输入密码")):a!==t.ruleForm2.pass?n(new Error("两次输入密码不一致!")):n()},trigger:"blur"}],pass:[{validator:function(t,e,a){""===e?a(new Error("请输入密码")):a()},trigger:"blur"}],account:[{validator:function(t,e,a){""===e?a(new Error("请输入账户")):a()},trigger:"blur"}]}}},methods:{submitForm:function(t){this.$refs[t].validate(function(t){if(!t)return console.log("error submit!!"),!1;alert("submit!")})},resetForm:function(t){this.$refs[t].resetFields()}}},q={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wrapper"},[a("div",{staticClass:"login"},[a("el-form",{ref:"ruleForm2",staticClass:"demo-ruleForm",attrs:{"label-position":"left",model:t.ruleForm2,"status-icon":"",rules:t.rules2,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"账户",prop:"account"}},[a("el-input",{model:{value:t.ruleForm2.account,callback:function(e){t.$set(t.ruleForm2,"account",t._n(e))},expression:"ruleForm2.account"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"pass"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:t.ruleForm2.pass,callback:function(e){t.$set(t.ruleForm2,"pass",e)},expression:"ruleForm2.pass"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"确认密码",prop:"checkPass"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:t.ruleForm2.checkPass,callback:function(e){t.$set(t.ruleForm2,"checkPass",e)},expression:"ruleForm2.checkPass"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"}},[t._v("注册")])],1)],1)],1)])},staticRenderFns:[]};var N=a("VU/8")(P,q,!1,function(t){a("EVg2")},"data-v-3b4dc030",null).exports,T={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-container",{staticStyle:{height:"768px","box-sizing":"border-box",border:"1px solid #eee"}},[a("el-aside",{staticStyle:{"background-color":"rgb(238, 241, 246)"},attrs:{width:"200px"}},[a("el-menu",{attrs:{"default-openeds":["1","3"]}},[a("el-submenu",{attrs:{index:"1"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-message"}),t._v("导航一")]),t._v(" "),a("el-menu-item-group",[a("template",{slot:"title"},[t._v("分组一")]),t._v(" "),a("el-menu-item",{attrs:{index:"1-1"},on:{click:function(e){t.$router.push("/pc/feature")}}},[t._v("脸部特征管理")]),t._v(" "),a("el-menu-item",{attrs:{index:"1-2"},on:{click:function(e){t.$router.push("/pc/test")}}},[t._v("测试AI标注")]),t._v(" "),a("el-menu-item",{attrs:{index:"1-3"},on:{click:function(e){t.$router.push("/pc/index")}}},[t._v("手工标注(业务)")]),t._v(" "),a("el-menu-item",{attrs:{index:"1-3"},on:{click:function(e){t.$router.push("/pc/train")}}},[t._v("手工标注(训练)")])],2),t._v(" "),a("el-submenu",{attrs:{index:"1-4"}},[a("template",{slot:"title"},[t._v("选项4")]),t._v(" "),a("el-menu-item",{attrs:{index:"1-4-1"}},[t._v("选项4-1")])],2)],2),t._v(" "),a("el-submenu",{attrs:{index:"2"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-menu"}),t._v("导航二")]),t._v(" "),a("el-menu-item-group",[a("template",{slot:"title"},[t._v("分组一")]),t._v(" "),a("el-menu-item",{attrs:{index:"2-1"}},[t._v("选项1")]),t._v(" "),a("el-menu-item",{attrs:{index:"2-2"}},[t._v("选项2")])],2),t._v(" "),a("el-menu-item-group",{attrs:{title:"分组2"}},[a("el-menu-item",{attrs:{index:"2-3"}},[t._v("选项3")])],1),t._v(" "),a("el-submenu",{attrs:{index:"2-4"}},[a("template",{slot:"title"},[t._v("选项4")]),t._v(" "),a("el-menu-item",{attrs:{index:"2-4-1"}},[t._v("选项4-1")])],2)],2),t._v(" "),a("el-submenu",{attrs:{index:"3"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-setting"}),t._v("导航三")]),t._v(" "),a("el-menu-item-group",[a("template",{slot:"title"},[t._v("分组一")]),t._v(" "),a("el-menu-item",{attrs:{index:"3-1"}},[t._v("选项1")]),t._v(" "),a("el-menu-item",{attrs:{index:"3-2"}},[t._v("选项2")])],2),t._v(" "),a("el-menu-item-group",{attrs:{title:"分组2"}},[a("el-menu-item",{attrs:{index:"3-3"}},[t._v("选项3")])],1),t._v(" "),a("el-submenu",{attrs:{index:"3-4"}},[a("template",{slot:"title"},[t._v("选项4")]),t._v(" "),a("el-menu-item",{attrs:{index:"3-4-1"}},[t._v("选项4-1")])],2)],2)],1)],1),t._v(" "),a("el-container",[a("el-header",{staticStyle:{"text-align":"right","font-size":"12px"}},[a("el-dropdown",[a("i",{staticClass:"el-icon-setting",staticStyle:{"margin-right":"15px"}}),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[t._v("查看")]),t._v(" "),a("el-dropdown-item",[t._v("新增")]),t._v(" "),a("el-dropdown-item",[t._v("删除")])],1)],1),t._v(" "),a("span",[t._v("王小虎")])],1),t._v(" "),a("el-main",[a("router-view")],1)],1)],1)},staticRenderFns:[]};var A=a("VU/8")({name:"pc"},T,!1,function(t){a("b5gC")},null,null).exports,B={name:"Index",data:function(){return{activeName:"first",labelData:[],notLabelData:[],labelTotal:20,notLabelTotal:20,qiniuUrl:I}},mounted:function(){this.init()},methods:{init:function(){var t=this;return u()(c.a.mark(function e(){var a,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v();case 2:return a=e.sent,t.labelData=a.data.data.rows,t.labelTotal=a.data.data.count,e.next=7,v(1);case 7:n=e.sent,t.notLabelData=n.data.data.rows,t.notLabelTotal=n.data.data.count;case 10:case"end":return e.stop()}},e,t)}))()},labelCurrentChange:function(t){var e=this;return u()(c.a.mark(function a(){var n;return c.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,v(0,t,20);case 2:n=a.sent,e.labelData=n.data.data.rows,e.labelTotal=n.data.data.count;case 5:case"end":return a.stop()}},a,e)}))()},notLabelCurrentChange:function(t){var e=this;return u()(c.a.mark(function a(){var n;return c.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,v(1,t,20);case 2:n=a.sent,e.notLabelData=n.data.data.rows,e.notLabelTotal=n.data.data.count;case 5:case"end":return a.stop()}},a,e)}))()},labelClick:function(t){console.log(t),this.$router.push({path:"/pc/label",query:{id:t.id,user_id:t.user_id,file_url:t.file_url}})},updateLabelClick:function(t){console.log(t),this.$router.push({path:"/pc/update_label",query:{id:t.id,user_id:t.user_id,file_url:t.file_url}})}}},W={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"未标注照片",name:"first"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:t.labelData}},[a("el-table-column",{attrs:{label:"照片",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{style:{backgroundImage:"url("+t.qiniuUrl(e.row.file_url)+")",backgroundSize:"cover",width:"75px",height:"75px"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"id",label:"照片id",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"created_at",label:"上传时间",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.labelClick(e.row)}}},[t._v("标注")])]}}])})],1),t._v(" "),a("el-pagination",{attrs:{background:"","page-size":20,layout:"prev, pager, next",total:t.labelTotal},on:{"current-change":t.labelCurrentChange}})],1),t._v(" "),a("el-tab-pane",{attrs:{label:"已标注照片",name:"second"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:t.notLabelData}},[a("el-table-column",{attrs:{label:"照片",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{style:{backgroundImage:"url("+t.qiniuUrl(e.row.file_url)+")",backgroundSize:"cover",width:"75px",height:"75px"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"id",label:"照片id",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"created_at",label:"上传时间",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.updateLabelClick(e.row)}}},[t._v("更改标注")])]}}])})],1),t._v(" "),a("el-pagination",{attrs:{background:"","page-size":20,layout:"prev, pager, next",total:t.notLabelTotal},on:{"current-change":t.notLabelCurrentChange}})],1)],1)},staticRenderFns:[]};var j=a("VU/8")(B,W,!1,function(t){a("gsAJ")},"data-v-58338f1b",null).exports,V=a("mvHQ"),H=a.n(V),M={data:function(){return{circles:[[143,198],[154,168]],scaling:1,computedFeatures:[]}},props:{photoId:{type:Number},fileUrl:{type:String,default:"http://os6zbdtt2.bkt.clouddn.com/Fmn93Hl1NzY2A9dP-FgBmrNzRxMa?nsukey=SoEyfKwopX0ZH%2FuoHP1Ua0s6xaa4DL6iW19AcUv6O%2Boenz4C25HDtZSIlkpHXh8NSvsi1fjAEGrCYrW%2BIpwRz%2FlYmzj53JVNt8iIgXERi2XX6VG5hWn8Mx75U%2F2qHQcvN9TJGT7y%2BXsjhLvjHAMP6vReveDWDdxKD9e46hk6rsuZUMU%2BznUPpAa8txpzGarQNoG2a%2FfZCvU4yg0LhZQBAg%3D%3D"}},mounted:function(){this.init()},methods:{computedFeature:function(){var t,e,a=void 0;t=this.circles,e=(t[37][1]-t[19][1])/(t[41][1]-t[37][1]),console.log(e),a=e>1?"眉眼间距远":e<.5?"眉眼间距近":"眉眼间距适中",this.computedFeatures.push(a),a=function(t){var e=(t[36][0]-t[17][0])/(t[39][0]-t[36][0]);return console.log(e),e>.25?"眉眼位置长过眼角20%":e<.15?"眉眼位置短于眼角20%":"眉眼位置适中"}(this.circles),this.computedFeatures.push(a),a=function(t){var e=t[22][0]-t[21][0]-(t[42][0]-t[39][0]);return console.log(e),e>0?"眉头相对宽于内眼角位置":e<0?"眉头相对窄于内眼角位置":"眉头相对等于内眼角位置"}(this.circles),this.computedFeatures.push(a),a=function(t){var e=(t[41][1]-t[37][1])/(t[39][0]-t[36][0]);return console.log(e),e>.35?"眼睛纵向长度大":e<1/3-1/3*.05?"眼睛纵向长度小":"眼睛纵向长度中等"}(this.circles),this.computedFeatures.push(a),a=function(t){var e=(t[42][0]-t[39][0])/(t[39][0]-t[36][0]);return console.log(e),e>1.05?"眼间距远":e<.95?"眼间距近":"眼间距适中"}(this.circles),this.computedFeatures.push(a),a=function(t){var e=(t[16][0]-t[0][0])/(t[39][0]-t[36][0]);return console.log(e),e>4.2?"眼睛短":e<3.8?"眼睛长":"眼睛长短中等"}(this.circles),this.computedFeatures.push(a),a=function(t){var e=(t[16][0]-t[0][0])/(t[36][0]-t[0][0]);return console.log(e),e>8.4?"外眼角离脸部轮廓短":e<7.6?"外眼角离脸部轮廓长":"外眼角离脸部轮廓适中"}(this.circles),this.computedFeatures.push(a),a=function(t){var e=(t[54][0]-t[48][0])/(t[35][0]-t[31][0])*1.1;return console.log(e),e>1.575?"嘴巴大":e<1.425?"嘴巴小":"嘴巴适中"}(this.circles),a=function(t){var e=(t[8][0]-t[33][0])/(t[62][0]-t[51][0]);return console.log(e),e>10.5?"嘴唇薄":e<9.5?"嘴唇厚":"嘴唇厚度适中"}(this.circles),this.computedFeatures.push(a),a=function(t){var e=1.1*(t[35][0]-t[31][0])-(t[22][0]-t[21][0]);return console.log(e),e>0?"鼻翼宽":e<0?"鼻翼窄":"鼻翼适中"}(this.circles),this.computedFeatures.push(a),a=function(t){var e=[{name:"上庭",length:t[19][1]-t[73][1]},{name:"中庭",length:t[33][1]-t[19][1]},{name:"下庭",length:t[8][1]-t[33][1]}],a=e.reduce(function(t,e){return t.length>e.length?t:e}),n=e.reduce(function(t,e){return t.length<e.length?t:e});return a.name+"最长，"+n.name+"最短"}(this.circles),this.computedFeatures.push(a)},addPonit:function(){var t=this;return u()(c.a.mark(function e(){var a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.circles.map(function(e){return[e.x*t.scaling,e.y*t.scaling]}),e.next=3,n=H()(a),r=t.photoId,p()({url:f+"photo/point_info",method:"post",data:{point_info:n,photo_id:r},withCredentials:!0});case 3:t.$message({message:"更新成功",type:"success"});case 4:case"end":return e.stop()}var n,r},e,t)}))()},formDataCircles:function(){if(this.circles=this.circles.map(function(t){return{x:t[0],y:t[1],isSelected:!1}}),82!==this.circles.length){var t=this.circles[28],e=this.circles[29],a={x:e.x-(e.y-t.y),y:e.y,isSelected:!1},n={x:e.x+(e.y-t.y),y:e.y,isSelected:!1};this.circles.push(a),this.circles.push(n)}},close:function(){this.$emit("close")},init:function(){var t=this;return u()(c.a.mark(function e(){var a,n,r,i,s,o,l,u,d,h,m,v,g,_;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return _=function(t){console.log(t);for(var e=t.pageX-s.getBoundingClientRect().left,a=t.pageY-s.getBoundingClientRect().top,r=n.length-1;r>=0;r--){var i=n[r];if(Math.sqrt(Math.pow(i.x-e,2)+Math.pow(i.y-a,2))<=u)return null!=h&&(h.isSelected=!1),h=i,i.isSelected=!0,g(m),s.onmousemove=function(t){var e=t.clientX-s.getBoundingClientRect().left,a=t.clientY-s.getBoundingClientRect().top;null!=h&&(h.isSelected=!1),h=i,i.isSelected=!0,i.x=e,i.y=a,g(m)},void(s.onmouseup=function(){s.onmousemove=null,s.onmouseup=null})}},g=function(t){o.clearRect(0,0,s.width,s.height),o.drawImage(t,0,0,s.width,s.height);for(var e=0;e<n.length;e++){var a=n[e];a.scale||(a.scale=!0,a.x=a.x/r.scaling,a.y=a.y/r.scaling);var i=v[0];e<=67&&(i=v[1]),e>=n.length-2&&(i=v[2]),e>67?(u=3,o.font="12px blod",o.fillStyle="blue",o.fillText(e,a.x+8,a.y-6)):u=1.5,o.globalAlpha=.85,o.beginPath(),o.arc(a.x,a.y,u,0,2*Math.PI),a.isSelected?(o.strokeStyle=i,o.lineWidth=3,o.stroke()):(o.fillStyle=i,o.fill())}},e.next=4,c=t.photoId,p()({url:f+"photo/point_info",method:"get",params:{photo_id:c},withCredentials:!0});case 4:(a=e.sent).data.data.label_point_info?t.circles=JSON.parse(a.data.data.label_point_info):t.circles=JSON.parse(a.data.data.point_info),t.computedFeature(),t.formDataCircles(),n=t.circles,r=t,i=t.fileUrl,s=document.createElement("canvas"),o=s.getContext("2d"),l=new Image,u=1.5,d=500,h=void 0,m=void 0,v=["#409EFF","white","green"],s.onmousedown=_,l.onload=function(t){r.scaling=this.width/d,s.width=this.width/r.scaling,s.height=this.height/r.scaling,g(m=this),r.$refs.container.appendChild(s)},l.src=i;case 22:case"end":return e.stop()}var c},e,t)}))()}}},O={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"wrapper"},[e("div",{staticClass:"btnBox"},[e("el-button",{attrs:{type:"primary"},on:{click:this.addPonit}},[this._v("更新")])],1),this._v(" "),e("div",{ref:"container"}),this._v(" "),e("div",[this._v("\n    "+this._s(this.computedFeatures.join("，"))+"\n    ")])])},staticRenderFns:[]};var X=a("VU/8")(M,O,!1,function(t){a("H2hR")},"data-v-d15654f8",null).exports,Z={name:"Label",data:function(){return{answerData:[],qiniuUrl:I,showPointBox:!1}},methods:{handleClick:function(t,e){console.log(t,e)},next:function(){var t=this;return u()(c.a.mark(function e(){var a,n,r,i;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!0,n={},t.answerData.forEach(function(t,e){n[t.info.key]={},t.list.forEach(function(e,r){e.answer||(a=!1);var i=e.item.id.toString();n[t.info.key][i]=e.answer})}),a){e.next=6;break}return t.$message.error("请将所有项目选择完，不能有不选的"),e.abrupt("return");case 6:return r={user_id:t.$route.query.user_id,photo_id:t.$route.query.id,base_feature:n},console.log(r),e.next=10,b(r);case 10:return e.next=12,m();case 12:return i=e.sent,i.data.data.rows[0]||t.$message({message:"没有更多了",type:"warning"}),e.abrupt("return");case 19:case"end":return e.stop()}},e,t)}))()},init:function(){var t=this;return u()(c.a.mark(function e(){var a,n,r,i;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g();case 2:for(r in a=e.sent,n=[],a.data.data){for(i in a.data.data[r].list)a.data.data[r].list[i].answer="";n.push(a.data.data[r])}console.log(n),t.answerData=n;case 7:case"end":return e.stop()}},e,t)}))()}},components:{NosePoit:X},mounted:function(){this.init()}},G={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticClass:"label-box"},[t._l(t.answerData,function(e){return a("div",[a("div",[a("span",{staticClass:"group-name"},[t._v(t._s(e.info.name))]),t._v(" "),t._l(e.list,function(e){return a("div",{staticClass:"feature-box"},[a("div",{staticClass:"feature-name"},[t._v(t._s(e.item.name))]),t._v(" "),a("div",{staticClass:"feature-list"},t._l(e.answer_list,function(n,r){return a("el-radio",{key:r,attrs:{label:n.id},model:{value:e.answer,callback:function(a){t.$set(e,"answer",a)},expression:"feature.answer"}},[t._v(t._s(n.name))])}))])})],2)])}),t._v(" "),a("div",{staticClass:"feature-box"},[a("el-button",{attrs:{type:"primary"},on:{click:t.next}},[t._v("下一个")])],1)],2),t._v(" "),a("div",{staticClass:"point-box"},[a("nose-poit",{attrs:{fileUrl:t.qiniuUrl(t.$route.query.file_url),photoId:parseInt(t.$route.query.id)},on:{close:function(e){t.showPointBox=!1}}})],1)])},staticRenderFns:[]};var J=a("VU/8")(Z,G,!1,function(t){a("Fw1l")},"data-v-6fe08450",null).exports,Y=a("woOf"),Q=a.n(Y),K=a("fZjL"),tt=a.n(K),et={name:"Label",data:function(){return{answerData:[],qiniuUrl:I,showPointBox:!1}},methods:{handleClick:function(t,e){console.log(t,e)},next:function(){var t=this;return u()(c.a.mark(function e(){var a,n,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!0,n={},t.answerData.forEach(function(t,e){n[t.info.key]={},t.list.forEach(function(e,r){e.answer||(a=!1);var i=e.item.id.toString();n[t.info.key][i]=e.answer})}),a){e.next=6;break}return t.$message.error("请将所有项目选择完，不能有不选的"),e.abrupt("return");case 6:return r={user_id:t.$route.query.user_id,photo_id:t.$route.query.id,base_feature:n},e.next=9,b(r);case 9:t.$message({message:"更改完成",type:"success"});case 10:case"end":return e.stop()}},e,t)}))()},init:function(){var t=this;return u()(c.a.mark(function e(){var a,n,r,i,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o=t.$route.query.id,p()({url:f+"feature/photo_feature",method:"get",params:{photo_id:o},withCredentials:!0});case 2:return a=e.sent,n=[],e.next=6,g();case 6:if(r=e.sent,a.data.data)!function(){var e={};tt()(a.data.data.base_feature).forEach(function(t){e=Q()({},e,a.data.data.base_feature[t])});var i=function(t){var a=function(a){tt()(e).forEach(function(n){r.data.data[t].list[a].item.id!==parseInt(n)||(r.data.data[t].list[a].answer=e[n])})};for(var i in r.data.data[t].list)a(i);n.push(r.data.data[t])};for(var s in r.data.data)i(s);t.answerData=n}();else{for(i in r.data.data){for(s in r.data.data[i].list)r.data.data[i].list[s].answer="";n.push(r.data.data[i])}console.log(n),t.answerData=n}case 8:case"end":return e.stop()}var o},e,t)}))()}},mounted:function(){this.init()},components:{NosePoit:X}},at={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticClass:"label-box"},[t._l(t.answerData,function(e){return a("div",[a("div",[a("span",{staticClass:"group-name"},[t._v(t._s(e.info.name))]),t._v(" "),t._l(e.list,function(e){return a("div",{staticClass:"feature-box"},[a("div",{staticClass:"feature-name"},[t._v(t._s(e.item.name))]),t._v(" "),a("div",{staticClass:"feature-list"},t._l(e.answer_list,function(n,r){return a("el-radio",{key:r,attrs:{label:n.id},model:{value:e.answer,callback:function(a){t.$set(e,"answer",a)},expression:"feature.answer"}},[t._v(t._s(n.name))])}))])})],2)])}),t._v(" "),a("div",{staticClass:"feature-box"},[a("el-button",{attrs:{type:"primary"},on:{click:t.next}},[t._v("更新")])],1)],2),t._v(" "),a("div",{staticClass:"point-box"},[a("nose-poit",{attrs:{fileUrl:t.qiniuUrl(t.$route.query.file_url),photoId:parseInt(t.$route.query.id)},on:{close:function(e){t.showPointBox=!1}}})],1)])},staticRenderFns:[]};var nt=a("VU/8")(et,at,!1,function(t){a("0VZb")},"data-v-412eb9b6",null).exports,rt={name:"Index",data:function(){return{treeData:[],defaultProps:{children:"children",label:"label"}}},mounted:function(){this.init()},methods:{delOpen:function(t){var e=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(u()(c.a.mark(function a(){return c.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,_(t);case 2:e.init(),e.$message({type:"success",message:"删除成功!"});case 4:case"end":return a.stop()}},a,e)}))).catch(function(){e.$message({type:"info",message:"已取消删除"})})},open:function(t){var e,a=this;this.$prompt("请输入名字","添加",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((e=u()(c.a.mark(function e(n){var r=n.value;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n=t,i=r,p()({url:f+"feature/feature_answer",method:"post",data:{feature_item_id:n,name:i},withCredentials:!0});case 2:a.init(),a.$message({type:"success",message:"添加成功!"});case 4:case"end":return e.stop()}var n,i},e,a)})),function(t){return e.apply(this,arguments)})).catch(function(){a.$message({type:"info",message:"取消输入"})})},openAddFeature:function(t){var e,a=this;this.$prompt("请输入名字","添加",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((e=u()(c.a.mark(function e(n){var r=n.value;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,addFeature(t,r);case 2:case"end":return e.stop()}},e,a)})),function(t){return e.apply(this,arguments)})).catch(function(){a.$message({type:"info",message:"取消输入"})})},renderContent:function(t,e){var a=this,n=e.node,r=e.data;e.store;return t("span",{class:"custom-tree-node"},[t("span",[n.label]),t("span",[2==n.level?t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(){2==n.level&&a.open(r.item.id)}}},["添加"]):null,3==n.level?t("el-button",{attrs:{size:"mini",type:"text"},on:{click:u()(c.a.mark(function t(){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a.delOpen(r.id);case 1:case"end":return t.stop()}},t,a)}))}},["删除"]):null])])},handleNodeClick:function(t){console.log(t)},init:function(){var t=this;return u()(c.a.mark(function e(){var a,n,r,i,s,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g();case 2:for(r in a=e.sent,n=[],a.data.data){for(s in(i=a.data.data[r]).label=i.info.name,i.list){for(o in i.list[s].label=i.list[s].item.name,i.list[s].answer_list)i.list[s].answer_list[o].label=i.list[s].answer_list[o].name;i.list[s].children=i.list[s].answer_list}i.children=i.list,n.push(i)}console.log(n),t.treeData=n;case 7:case"end":return e.stop()}},e,t)}))()},handleClick:function(t){this.$router.push({path:"/label",query:{id:t.id}})}}},it={render:function(){var t=this.$createElement;return(this._self._c||t)("el-tree",{attrs:{data:this.treeData,props:this.defaultProps,accordion:"","render-content":this.renderContent},on:{"node-click":this.handleNodeClick}})},staticRenderFns:[]};var st=a("VU/8")(rt,it,!1,function(t){a("OhVj")},"data-v-5afcaebc",null).exports,ot={data:function(){return{imageUrl:"",originalUrl:"",width:"",height:"",originalFile:"",uploadTime:"",analyzeFaceTime:"",url:"",loading:!1}},methods:{uploadBase64:function(t){var e=this;return u()(c.a.mark(function a(){var n,r,i,s,o,l,u,d,p,f;return c.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n=e,r=new Date,i=t.split(","),s=i[0].match(/:(.*?);/)[1],o=s.length,l=parseInt(o+13),u=(u=t.substring(l)).replace(/^.*?,/,""),a.next=8,x();case 8:d=(d=a.sent).data.data.token,p="http://upload.qiniup.com/putb64/-1",(f=new XMLHttpRequest).onreadystatechange=function(){if(4==f.readyState){var t=new Date-r;n.uploadTime=t;var e="http://pc43w2wc6.bkt.clouddn.com/"+JSON.parse(f.responseText).hash;n.url=e,n.analyzeFace()}},f.open("POST",p,!0),f.setRequestHeader("Content-Type","application/octet-stream"),f.setRequestHeader("Authorization","UpToken "+d),f.send(u);case 17:case"end":return a.stop()}},a,e)}))()},upload:function(t){var e=this;return u()(c.a.mark(function a(){var n,r,i,s,o,l,u,d;return c.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(t){a.next=2;break}return a.abrupt("return");case 2:return e.loading=!0,e.imageUrl=URL.createObjectURL(t),e.getWH(),a.prev=5,n=new Date,a.next=9,x();case 9:return r=(r=a.sent).data.data.token,(i=new FormData).append("token",r),i.append("file",t),a.next=16,c=i,p()({url:"http://upload.qiniup.com",method:"post",data:c});case 16:return s=a.sent,o=s.data.hash,l="http://pc43w2wc6.bkt.clouddn.com/"+o,e.url=l,u=new Date,d=u-n,e.uploadTime=d,a.next=25,e.analyzeFace();case 25:a.next=31;break;case 27:a.prev=27,a.t0=a.catch(5),console.log(a.t0),e.loading=!1;case 31:case"end":return a.stop()}var c},a,e,[[5,27]])}))()},analyzeFace:function(){var t=this;return u()(c.a.mark(function e(){var a,n,r,i,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.url){e.next=3;break}return e.abrupt("return");case 3:return n=new Date,e.next=6,w(a);case 6:r=e.sent,i=new Date,s=i-n,t.analyzeFaceTime=s,t.loading=!1,t.drawPoint(r.data.data.faceInfo.landmark);case 12:case"end":return e.stop()}},e,t)}))()},getWH:function(){var t=this,e=new Image;e.onload=function(e){t.width=this.width,t.height=this.height},e.src=this.imageUrl},selectImg:function(t){var e=t.target.files[0];this.imageUrl=URL.createObjectURL(e),this.originalUrl=URL.createObjectURL(e),this.originalFile=e,this.getWH()},zoom:function(t){this.loading=!0;var e=this,a=document.createElement("canvas"),n=a.getContext("2d"),r=new Image;r.onload=function(r){var i=this.width/t,s=this.height/i;a.width=t,a.height=s,n.drawImage(this,0,0,t,s);var o=a.toDataURL("image/png");e.imageUrl=o,e.getWH(),e.uploadBase64(o)},r.src=this.originalUrl},drawPoint:function(t){var e=this,a=document.createElement("canvas"),n=a.getContext("2d"),r=new Image;r.onload=function(r){a.width=this.width,a.height=this.height,n.drawImage(this,0,0,this.width,this.height),t.forEach(function(t,e){var a=t[0],r=t[1],i=2*Math.PI;n.beginPath(),n.fillStyle="#409EFF",n.arc(a,r,3,0,i),n.fill()});var i=a.toDataURL("image/png");e.imageUrl=i},r.src=this.imageUrl}}},ct={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[a("div",{staticClass:"top"},[a("div",{staticClass:"imgBox"},[a("img",{attrs:{src:t.imageUrl,alt:""}})]),t._v(" "),a("div",{staticClass:"info"},[a("p",[t._v("当前宽度: "+t._s(this.width)+"px")]),t._v(" "),a("p",[t._v("当前高度: "+t._s(this.height)+"px")]),t._v(" "),a("p",[t._v("上传时间: "+t._s(this.uploadTime)+"ms")]),t._v(" "),a("p",[t._v("识别时间: "+t._s(this.analyzeFaceTime)+"ms")])])]),t._v(" "),a("div",{staticClass:"btnBox"},[a("input",{attrs:{name:"file",type:"file",accept:"image/*"},on:{change:t.selectImg}}),t._v(" "),a("el-row",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.upload(t.originalFile)}}},[t._v("原图识别")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.zoom(1024)}}},[t._v("压缩1024识别")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.zoom(512)}}},[t._v("压缩512识别")])],1)],1)])},staticRenderFns:[]};var lt=a("VU/8")(ot,ct,!1,function(t){a("+c8h")},"data-v-7bd112ec",null).exports,ut={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"featureBox"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.$router.push("/forehead")}}},[t._v("标记额头")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.$router.push("/jaw")}}},[t._v("标记下巴")])],1)},staticRenderFns:[]};var dt=a("VU/8")({data:function(){return{}},methods:{},mounted:function(){}},ut,!1,function(t){a("wbLO")},"data-v-01e5abbe",null).exports,pt={data:function(){return{scaling:1,circles:[],fileUrl:"http://os6zbdtt2.bkt.clouddn.com/Fmn93Hl1NzY2A9dP-FgBmrNzRxMa?nsukey=SoEyfKwopX0ZH%2FuoHP1Ua0s6xaa4DL6iW19AcUv6O%2Boenz4C25HDtZSIlkpHXh8NSvsi1fjAEGrCYrW%2BIpwRz%2FlYmzj53JVNt8iIgXERi2XX6VG5hWn8Mx75U%2F2qHQcvN9TJGT7y%2BXsjhLvjHAMP6vReveDWDdxKD9e46hk6rsuZUMU%2BznUPpAa8txpzGarQNoG2a%2FfZCvU4yg0LhZQBAg%3D%3D",imgId:"",count:{0:0,1:1}}},methods:{formDataCircles:function(){this.circles=this.circles.map(function(t){return{x:t[0],y:t[1]}})},discard:function(){var t=this;return u()(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.circles=[],e.next=3,t.getImgUrl();case 3:t.$refs.canvasWrapper.removeChild(t.$refs.canvasWrapper.firstChild),t.init();case 5:case"end":return e.stop()}},e,t)}))()},sendPoint:function(){var t=this;return u()(c.a.mark(function e(){var a,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.circles.map(function(e){return[parseInt(e.x*t.scaling),parseInt(e.y*t.scaling)]}),e.next=3,k(t.imgId,0,H()(a));case 3:n=e.sent,console.log(n),t.discard();case 6:case"end":return e.stop()}},e,t)}))()},revocation:function(){this.circles.pop(),this.$refs.canvasWrapper.removeChild(this.$refs.canvasWrapper.firstChild),this.init()},getImgUrl:function(){var t=this;return u()(c.a.mark(function e(){var a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(0);case 2:return a=e.sent,t.fileUrl=I(a.data.data.url),t.imgId=a.data.data.img_id,e.next=7,C(t.$store.state.userInfo.username);case 7:a=e.sent,t.count=a.data.data;case 9:case"end":return e.stop()}},e,t)}))()},init:function(){var t=this;return u()(c.a.mark(function e(){var a,n,r,i,s,o,l,u,d,p,f;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:f=function(t){console.log(t);var e=t.pageX-i.getBoundingClientRect().left,n=t.pageY-i.getBoundingClientRect().top;a.circles.push({x:e,y:n,scale:!0}),p(u),console.log(a.circles)},p=function(t){s.clearRect(0,0,i.width,i.height),s.drawImage(t,0,0,i.width,i.height);for(var e=0;e<n.length;e++){var r=n[e];r.scale||(r.scale=!0,r.x=r.x/a.scaling,r.y=r.y/a.scaling),s.font="12px blod",s.fillStyle="red",s.fillText(e+1,r.x+8,r.y-6),s.globalAlpha=.85,s.beginPath(),s.arc(r.x,r.y,o,0,2*Math.PI),s.fillStyle="blue",s.fill()}},a=t,n=t.circles,r=t.fileUrl,i=document.createElement("canvas"),s=i.getContext("2d"),o=3,l=t.$refs.canvasWrapper.offsetWidth,t.$refs.canvasWrapper.style.height=l+"px",u=void 0,d=new Image,i.onmousedown=f,d.onload=function(t){this.width>this.height?a.scaling=this.width/l:a.scaling=this.height/l,i.width=this.width/a.scaling,i.height=this.height/a.scaling,console.log(a.scaling,i.width,i.height),p(u=this),a.$refs.canvasWrapper.appendChild(i)},d.src=r;case 16:case"end":return e.stop()}},e,t)}))()}},mounted:function(){var t=this;return u()(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getImgUrl();case 2:t.init();case 3:case"end":return e.stop()}},e,t)}))()}},ft={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wrapper"},[a("div",{ref:"canvasWrapper",staticClass:"canvasWrapper"}),t._v(" "),a("div",{staticClass:"btnBox"},[a("el-button",{attrs:{type:"primary"},on:{click:t.sendPoint}},[t._v("确认并下一个")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.revocation}},[t._v("撤销")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.discard}},[t._v("丢弃")])],1),t._v(" "),a("div",{staticClass:"countBox"},[a("span",[t._v("标记额头数目："+t._s(t.count[0]))]),t._v(" "),a("span",[t._v("标记下巴数目："+t._s(t.count[1]))])])])},staticRenderFns:[]};var ht=a("VU/8")(pt,ft,!1,function(t){a("gnWR")},"data-v-5ba8e999",null).exports,mt={data:function(){return{fileUrl:"",imgId:"",info:"",count:{0:0,1:1}}},methods:{sendPoint:function(){var t=this;return u()(c.a.mark(function e(){var a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k(t.imgId,1,t.info);case 2:a=e.sent,console.log(a),t.discard();case 5:case"end":return e.stop()}},e,t)}))()},discard:function(){var t=this;return u()(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getImgUrl();case 2:t.info="";case 3:case"end":return e.stop()}},e,t)}))()},getImgUrl:function(){var t=this;return u()(c.a.mark(function e(){var a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(1);case 2:return a=e.sent,t.fileUrl=I(a.data.data.url),t.imgId=a.data.data.img_id,e.next=7,C(t.$store.state.userInfo.username);case 7:a=e.sent,t.count=a.data.data;case 9:case"end":return e.stop()}},e,t)}))()}},mounted:function(){var t=this;return u()(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getImgUrl();case 2:case"end":return e.stop()}},e,t)}))()}},vt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wrapper"},[a("img",{staticClass:"img",attrs:{src:t.fileUrl}}),t._v(" "),a("div",{staticClass:"select"},[a("el-radio",{attrs:{label:"118"},model:{value:t.info,callback:function(e){t.info=e},expression:"info"}},[t._v("方下巴")]),t._v(" "),a("el-radio",{attrs:{label:"119"},model:{value:t.info,callback:function(e){t.info=e},expression:"info"}},[t._v("圆下巴")]),t._v(" "),a("el-radio",{attrs:{label:"120"},model:{value:t.info,callback:function(e){t.info=e},expression:"info"}},[t._v("尖下巴")])],1),t._v(" "),a("div",{staticClass:"btnBox"},[a("el-button",{attrs:{type:"primary"},on:{click:t.sendPoint}},[t._v("确认并下一个")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.discard}},[t._v("丢弃")])],1),t._v(" "),a("div",{staticClass:"countBox"},[a("span",[t._v("标记额头数目："+t._s(t.count[0]))]),t._v(" "),a("span",[t._v("标记下巴数目："+t._s(t.count[1]))])])])},staticRenderFns:[]};var gt=a("VU/8")(mt,vt,!1,function(t){a("UJUZ")},"data-v-6614e158",null).exports,_t={data:function(){return{scaling:1,circles:[],fileUrl:"http://os6zbdtt2.bkt.clouddn.com/Fmn93Hl1NzY2A9dP-FgBmrNzRxMa?nsukey=SoEyfKwopX0ZH%2FuoHP1Ua0s6xaa4DL6iW19AcUv6O%2Boenz4C25HDtZSIlkpHXh8NSvsi1fjAEGrCYrW%2BIpwRz%2FlYmzj53JVNt8iIgXERi2XX6VG5hWn8Mx75U%2F2qHQcvN9TJGT7y%2BXsjhLvjHAMP6vReveDWDdxKD9e46hk6rsuZUMU%2BznUPpAa8txpzGarQNoG2a%2FfZCvU4yg0LhZQBAg%3D%3D",imgId:""}},methods:{formDataCircles:function(){this.circles=this.circles.map(function(t){return{x:t[0],y:t[1]}})},discard:function(){var t=this;return u()(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$(t.imgId,0);case 3:t.$message({type:"success",message:"丢弃成功!"}),t.$router.go(-1),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}},e,t,[[0,7]])}))()},sendPoint:function(){var t=this;return u()(c.a.mark(function e(){var a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.circles.map(function(e){return[parseInt(e.x*t.scaling),parseInt(e.y*t.scaling)]}),e.next=3,k(t.imgId,0,H()(a));case 3:e.sent,t.$refs.canvasWrapper.removeChild(t.$refs.canvasWrapper.firstChild),t.init(),t.$message({type:"success",message:"更改成功!"});case 7:case"end":return e.stop()}},e,t)}))()},revocation:function(){this.circles.pop(),this.$refs.canvasWrapper.removeChild(this.$refs.canvasWrapper.firstChild),this.init()},getImgUrl:function(){var t=this;return u()(c.a.mark(function e(){var a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.imgId=t.$route.query.id,e.next=3,F(t.imgId);case 3:a=e.sent,t.fileUrl=I(a.data.data.url),t.circles=JSON.parse(a.data.data[0]);case 6:case"end":return e.stop()}},e,t)}))()},init:function(){var t=this;return u()(c.a.mark(function e(){var a,n,r,i,s,o,l,u,d,p,f;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:f=function(t){console.log(t);var e=t.pageX-i.getBoundingClientRect().left,n=t.pageY-i.getBoundingClientRect().top;a.circles.push({x:e,y:n,scale:!0}),p(u),console.log(a.circles)},p=function(t){s.clearRect(0,0,i.width,i.height),s.drawImage(t,0,0,i.width,i.height);for(var e=0;e<n.length;e++){var r=n[e];r.scale||(r.scale=!0,r.x=r.x/a.scaling,r.y=r.y/a.scaling),s.font="12px blod",s.fillStyle="red",s.fillText(e+1,r.x+8,r.y-6),s.globalAlpha=.85,s.beginPath(),s.arc(r.x,r.y,o,0,2*Math.PI),s.fillStyle="blue",s.fill()}},a=t,n=t.circles,r=t.fileUrl,i=document.createElement("canvas"),s=i.getContext("2d"),o=3,l=t.$refs.canvasWrapper.offsetWidth,t.$refs.canvasWrapper.style.height=l+"px",u=void 0,d=new Image,i.onmousedown=f,d.onload=function(t){this.width>this.height?a.scaling=this.width/l:a.scaling=this.height/l,i.width=this.width/a.scaling,i.height=this.height/a.scaling,console.log(a.scaling,i.width,i.height),p(u=this),a.$refs.canvasWrapper.appendChild(i)},d.src=r;case 16:case"end":return e.stop()}},e,t)}))()}},mounted:function(){var t=this;return u()(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getImgUrl();case 2:t.formDataCircles(),t.init();case 4:case"end":return e.stop()}},e,t)}))()}},bt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wrapper"},[a("div",{ref:"canvasWrapper",staticClass:"canvasWrapper"}),t._v(" "),a("div",{staticClass:"btnBox"},[a("el-button",{attrs:{type:"primary"},on:{click:t.sendPoint}},[t._v("更改")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.revocation}},[t._v("撤销")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.discard}},[t._v("丢弃")])],1)])},staticRenderFns:[]};var wt=a("VU/8")(_t,bt,!1,function(t){a("umEy")},"data-v-17710e42",null).exports,xt={data:function(){return{fileUrl:"",imgId:"",info:""}},methods:{sendPoint:function(){var t=this;return u()(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k(t.imgId,1,t.info);case 2:e.sent,t.$message({type:"success",message:"更新成功!"});case 4:case"end":return e.stop()}},e,t)}))()},discard:function(){var t=this;return u()(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$(t.imgId,1);case 3:t.$message({type:"success",message:"丢弃成功!"}),t.$router.go(-1),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}},e,t,[[0,7]])}))()},getImgUrl:function(){var t=this;return u()(c.a.mark(function e(){var a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.imgId=t.$route.query.id,e.next=3,F(t.imgId);case 3:a=e.sent,t.fileUrl=I(a.data.data.url),t.info=a.data.data[1];case 6:case"end":return e.stop()}},e,t)}))()}},mounted:function(){var t=this;return u()(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getImgUrl();case 2:case"end":return e.stop()}},e,t)}))()}},yt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wrapper"},[a("img",{staticClass:"img",attrs:{src:t.fileUrl}}),t._v(" "),a("div",{staticClass:"select"},[a("el-radio",{attrs:{label:"118"},model:{value:t.info,callback:function(e){t.info=e},expression:"info"}},[t._v("方下巴")]),t._v(" "),a("el-radio",{attrs:{label:"119"},model:{value:t.info,callback:function(e){t.info=e},expression:"info"}},[t._v("圆下巴")]),t._v(" "),a("el-radio",{attrs:{label:"120"},model:{value:t.info,callback:function(e){t.info=e},expression:"info"}},[t._v("尖下巴")])],1),t._v(" "),a("div",{staticClass:"btnBox"},[a("el-button",{attrs:{type:"primary"},on:{click:t.sendPoint}},[t._v("更改")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.discard}},[t._v("丢弃")])],1)])},staticRenderFns:[]};var kt=a("VU/8")(xt,yt,!1,function(t){a("k37S")},"data-v-72ccdf10",null).exports,Ct={data:function(){return{users:[]}},methods:{goUserDetail:function(t){console.log(t),this.$router.push({path:"/userdetail",query:{username:t}})},init:function(){var t=this;return u()(c.a.mark(function e(){var a,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p()({url:h+"features/summary",method:"get",withCredentials:!0});case 2:a=e.sent,n=a.data.data,t.users=tt()(n).map(function(t){return{username:t,forehead_count:n[t][0],jaw_count:n[t][1]}});case 5:case"end":return e.stop()}},e,t)}))()}},mounted:function(){var t=this;return u()(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.init();case 2:case"end":return e.stop()}},e,t)}))()}},Ut={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wrapper"},[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:t.users}},[a("el-table-column",{attrs:{prop:"username",label:"用户名",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"forehead_count",label:"标记额头数",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"jaw_count",label:"标记下巴数",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.goUserDetail(e.row.username)}}},[t._v("查看详情")])]}}])})],1)],1)},staticRenderFns:[]};var Ft=a("VU/8")(Ct,Ut,!1,function(t){a("PzLo")},"data-v-1526207c",null).exports,$t={data:function(){return{activeName:"first",foreheadData:[],jawData:[],qiniuUrl:I}},beforeRouteEnter:function(t,e,a){"/users"==e.path?t.meta.keepAlive=!1:t.meta.keepAlive=!0,a()},methods:{goForehead:function(t){this.$router.push({path:"/updateforehead",query:{id:t}})},goJaw:function(t){this.$router.push({path:"/updatejaw",query:{id:t}})},init:function(){var t=this;return u()(c.a.mark(function e(){var a,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.$route.query.username,e.next=3,U(a);case 3:n=e.sent,console.log(n),t.foreheadData=n.data.data[0],t.jawData=n.data.data[1];case 7:case"end":return e.stop()}},e,t)}))()}},mounted:function(){var t=this;return u()(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.init();case 2:case"end":return e.stop()}},e,t)}))()}},It={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"额头",name:"first"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:t.foreheadData}},[a("el-table-column",{attrs:{label:"照片",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{style:{backgroundImage:"url("+t.qiniuUrl(e.row.url)+")",backgroundSize:"cover",width:"75px",height:"75px"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"id",label:"照片id",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.goForehead(e.row.id)}}},[t._v("查看额头")])]}}])})],1)],1),t._v(" "),a("el-tab-pane",{attrs:{label:"下巴",name:"second"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:t.jawData}},[a("el-table-column",{attrs:{label:"照片",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{style:{backgroundImage:"url("+t.qiniuUrl(e.row.url)+")",backgroundSize:"cover",width:"75px",height:"75px"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"id",label:"照片id",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.goJaw(e.row.id)}}},[t._v("查看下巴")])]}}])})],1)],1)],1)},staticRenderFns:[]};var St=a("VU/8")($t,It,!1,function(t){a("no6g")},"data-v-566c3e6a",null).exports,Dt=a("NYxO"),Et=a("2mV7");n.default.use(Dt.a);var Rt=new Dt.a.Store({modules:Et.default}),zt={checkAuth:function(){return t=u()(c.a.mark(function t(e,a,n){var r,i,s;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.matched.some(function(t){return t.meta.requireAuth})){t.next=21;break}if(!Rt.state.userInfo.isLogin){t.next=5;break}n(),t.next=19;break;case 5:return t.prev=5,t.next=8,p()({url:h+"features/issignin",method:"get",withCredentials:!0});case 8:r=t.sent,i=r.data.data.is_sign_in,s=r.data.data.username,Rt.commit("SET_USER_ISLOGIN",i),Rt.commit("SET_USERNAME",s),i?n():n("/login"),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(5),console.log(t.t0);case 19:t.next=22;break;case 21:n();case 22:case"end":return t.stop()}},t,this,[[5,16]])})),function(e,a,n){return t.apply(this,arguments)};var t}};n.default.use(s.a);var Lt=new s.a({routes:[{path:"/",redirect:"/choose"},{path:"/login",component:L},{path:"/register",component:N},{path:"/choose",component:dt,meta:{requireAuth:!0}},{path:"/forehead",component:ht,meta:{requireAuth:!0}},{path:"/updateforehead",component:wt,meta:{requireAuth:!0}},{path:"/users",component:Ft,meta:{requireAuth:!0,keepAlive:!0}},{path:"/userdetail",component:St,meta:{requireAuth:!0,keepAlive:!0}},{path:"/jaw",component:gt,meta:{requireAuth:!0}},{path:"/updatejaw",component:kt,meta:{requireAuth:!0}},{path:"/pc",component:A,children:[{path:"index",name:"Index",component:E},{path:"train",name:"Train",component:j},{path:"label",name:"Label",component:J},{path:"update_label",name:"UpdateLabel",component:nt},{path:"feature",name:"Feature",component:st},{path:"test",name:"TestAiLabelFace",component:lt},{path:"nose_point",name:"NosePoint",component:X}]}]});Lt.beforeEach(zt.checkAuth());var Pt=Lt,qt=a("zL8q"),Nt=a.n(qt);a("tvR6");n.default.config.productionTip=!1,n.default.use(Nt.a),new n.default({el:"#app",router:Pt,store:Rt,components:{App:i},template:"<App/>"})},OhVj:function(t,e){},PgRt:function(t,e){},PzLo:function(t,e){},QmKZ:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default={state:{isLogin:!1,username:""},mutations:{SET_USER_ISLOGIN:function(t,e){t.isLogin=e},SET_USERNAME:function(t,e){t.username=e}},getters:{}}},UJUZ:function(t,e){},b5gC:function(t,e){},gNcp:function(t,e,a){var n={"./index.js":"2mV7","./userInfo.js":"QmKZ"};function r(t){return a(i(t))}function i(t){var e=n[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}r.keys=function(){return Object.keys(n)},r.resolve=i,t.exports=r,r.id="gNcp"},gnWR:function(t,e){},gsAJ:function(t,e){},k37S:function(t,e){},no6g:function(t,e){},oWsi:function(t,e){},tvR6:function(t,e){},umEy:function(t,e){},vUjk:function(t,e){},wbLO:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.eb8d880927f2a7045736.js.map