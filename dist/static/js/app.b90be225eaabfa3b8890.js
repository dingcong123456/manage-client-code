webpackJsonp([1],{"+c8h":function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("7+uW"),i={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("el-container",{staticStyle:{height:"768px","box-sizing":"border-box",border:"1px solid #eee"}},[n("el-aside",{staticStyle:{"background-color":"rgb(238, 241, 246)"},attrs:{width:"200px"}},[n("el-menu",{attrs:{"default-openeds":["1","3"]}},[n("el-submenu",{attrs:{index:"1"}},[n("template",{slot:"title"},[n("i",{staticClass:"el-icon-message"}),t._v("导航一")]),t._v(" "),n("el-menu-item-group",[n("template",{slot:"title"},[t._v("分组一")]),t._v(" "),n("el-menu-item",{attrs:{index:"1-1"},on:{click:function(e){t.$router.push("feature")}}},[t._v("脸部特征管理")]),t._v(" "),n("el-menu-item",{attrs:{index:"1-2"},on:{click:function(e){t.$router.push("test")}}},[t._v("测试AI标注")]),t._v(" "),n("el-menu-item",{attrs:{index:"1-3"},on:{click:function(e){t.$router.push("index")}}},[t._v("手工标注")])],2),t._v(" "),n("el-submenu",{attrs:{index:"1-4"}},[n("template",{slot:"title"},[t._v("选项4")]),t._v(" "),n("el-menu-item",{attrs:{index:"1-4-1"}},[t._v("选项4-1")])],2)],2),t._v(" "),n("el-submenu",{attrs:{index:"2"}},[n("template",{slot:"title"},[n("i",{staticClass:"el-icon-menu"}),t._v("导航二")]),t._v(" "),n("el-menu-item-group",[n("template",{slot:"title"},[t._v("分组一")]),t._v(" "),n("el-menu-item",{attrs:{index:"2-1"}},[t._v("选项1")]),t._v(" "),n("el-menu-item",{attrs:{index:"2-2"}},[t._v("选项2")])],2),t._v(" "),n("el-menu-item-group",{attrs:{title:"分组2"}},[n("el-menu-item",{attrs:{index:"2-3"}},[t._v("选项3")])],1),t._v(" "),n("el-submenu",{attrs:{index:"2-4"}},[n("template",{slot:"title"},[t._v("选项4")]),t._v(" "),n("el-menu-item",{attrs:{index:"2-4-1"}},[t._v("选项4-1")])],2)],2),t._v(" "),n("el-submenu",{attrs:{index:"3"}},[n("template",{slot:"title"},[n("i",{staticClass:"el-icon-setting"}),t._v("导航三")]),t._v(" "),n("el-menu-item-group",[n("template",{slot:"title"},[t._v("分组一")]),t._v(" "),n("el-menu-item",{attrs:{index:"3-1"}},[t._v("选项1")]),t._v(" "),n("el-menu-item",{attrs:{index:"3-2"}},[t._v("选项2")])],2),t._v(" "),n("el-menu-item-group",{attrs:{title:"分组2"}},[n("el-menu-item",{attrs:{index:"3-3"}},[t._v("选项3")])],1),t._v(" "),n("el-submenu",{attrs:{index:"3-4"}},[n("template",{slot:"title"},[t._v("选项4")]),t._v(" "),n("el-menu-item",{attrs:{index:"3-4-1"}},[t._v("选项4-1")])],2)],2)],1)],1),t._v(" "),n("el-container",[n("el-header",{staticStyle:{"text-align":"right","font-size":"12px"}},[n("el-dropdown",[n("i",{staticClass:"el-icon-setting",staticStyle:{"margin-right":"15px"}}),t._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",[t._v("查看")]),t._v(" "),n("el-dropdown-item",[t._v("新增")]),t._v(" "),n("el-dropdown-item",[t._v("删除")])],1)],1),t._v(" "),n("span",[t._v("王小虎")])],1),t._v(" "),n("el-main",[n("router-view")],1)],1)],1)],1)},staticRenderFns:[]};var r=n("VU/8")({name:"App"},i,!1,function(t){n("NJb4")},null,null).exports,s=n("/ocq"),o=n("Xxa5"),l=n.n(o),c=n("exGp"),u=n.n(c),d=n("mtWM"),p=n.n(d),f="http://manage.sharezdm.cn/";function h(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;return p()({url:f+"photo/list",method:"get",params:{page_num:e,page_size:n,is_label:t},withCredentials:!0})}function m(){return p()({url:f+"feature/list",method:"get",withCredentials:!0})}function v(t){return p()({url:f+"feature/feature_answer",method:"delete",data:{id:t},withCredentials:!0})}function _(t){return p()({url:f+"feature/addphotofeature",method:"post",data:t,withCredentials:!0})}function g(t){return p()({url:"http://diff.sharezdm.cn/index/analyzefacepro",method:"post",data:{image_url:t}})}function w(){return p()({url:"http://diff.sharezdm.cn/index/getuploadtoken",method:"get",withCredentials:!0})}function x(t){return"http://pc43w2wc6.bkt.clouddn.com/"+t}var b={name:"Index",data:function(){return{activeName:"first",labelData:[],notLabelData:[],qiniuUrl:x}},mounted:function(){this.init()},methods:{init:function(){var t=this;return u()(l.a.mark(function e(){var n,a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h();case 2:return n=e.sent,t.labelData=n.data.data.rows,e.next=6,h(1);case 6:a=e.sent,t.notLabelData=a.data.data.rows;case 8:case"end":return e.stop()}},e,t)}))()},labelClick:function(t){console.log(t),this.$router.push({path:"/label",query:{id:t.id,user_id:t.user_id,file_url:t.file_url}})},updateLabelClick:function(t){console.log(t),this.$router.push({path:"/update_label",query:{id:t.id,user_id:t.user_id,file_url:t.file_url}})}}},y={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[n("el-tab-pane",{attrs:{label:"未标注照片",name:"first"}},[n("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:t.labelData}},[n("el-table-column",{attrs:{label:"照片",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",{style:{backgroundImage:"url("+t.qiniuUrl(e.row.file_url)+")",backgroundSize:"cover",width:"75px",height:"75px"}})]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"id",label:"照片id",width:"180"}}),t._v(" "),n("el-table-column",{attrs:{prop:"created_at",label:"上传时间",width:"180"}}),t._v(" "),n("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(n){t.labelClick(e.row)}}},[t._v("标注")])]}}])})],1)],1),t._v(" "),n("el-tab-pane",{attrs:{label:"已标注照片",name:"second"}},[n("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:t.notLabelData}},[n("el-table-column",{attrs:{label:"照片",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",{style:{backgroundImage:"url("+t.qiniuUrl(e.row.file_url)+")",backgroundSize:"cover",width:"75px",height:"75px"}})]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"id",label:"照片id",width:"180"}}),t._v(" "),n("el-table-column",{attrs:{prop:"created_at",label:"上传时间",width:"180"}}),t._v(" "),n("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(n){t.updateLabelClick(e.row)}}},[t._v("更改标注")])]}}])})],1)],1)],1)},staticRenderFns:[]};var k=n("VU/8")(b,y,!1,function(t){n("QQxm")},"data-v-2bd09577",null).exports,C=n("mvHQ"),U=n.n(C),$={data:function(){return{circles:[[143,198],[154,168]]}},props:{photoId:{type:Number},fileUrl:{type:String,default:"http://os6zbdtt2.bkt.clouddn.com/Fmn93Hl1NzY2A9dP-FgBmrNzRxMa?nsukey=SoEyfKwopX0ZH%2FuoHP1Ua0s6xaa4DL6iW19AcUv6O%2Boenz4C25HDtZSIlkpHXh8NSvsi1fjAEGrCYrW%2BIpwRz%2FlYmzj53JVNt8iIgXERi2XX6VG5hWn8Mx75U%2F2qHQcvN9TJGT7y%2BXsjhLvjHAMP6vReveDWDdxKD9e46hk6rsuZUMU%2BznUPpAa8txpzGarQNoG2a%2FfZCvU4yg0LhZQBAg%3D%3D"}},mounted:function(){this.init()},methods:{addPonit:function(){var t=this;return u()(l.a.mark(function e(){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.circles.map(function(t){return[t.x,t.y]}),e.next=3,a=U()(n),i=t.photoId,p()({url:f+"photo/point_info",method:"post",data:{point_info:a,photo_id:i},withCredentials:!0});case 3:t.$message({message:"更新成功",type:"success"});case 4:case"end":return e.stop()}var a,i},e,t)}))()},formDataCircles:function(){if(this.circles=this.circles.map(function(t){return{x:t[0],y:t[1],isSelected:!1}}),82!==this.circles.length){var t=this.circles[28],e=this.circles[29],n={x:e.x-(e.y-t.y),y:e.y,isSelected:!1},a={x:e.x+(e.y-t.y),y:e.y,isSelected:!1};this.circles.push(n),this.circles.push(a)}},close:function(){this.$emit("close")},init:function(){var t=this;return u()(l.a.mark(function e(){var n,a,i,r,s,o,c,u,d,h,m,v,_;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return _=function(t){for(var e=t.pageX-s.offsetLeft,n=t.pageY-s.offsetTop,i=a.length-1;i>=0;i--){var r=a[i];if(Math.sqrt(Math.pow(r.x-e,2)+Math.pow(r.y-n,2))<=u)return null!=d&&(d.isSelected=!1),d=r,r.isSelected=!0,v(h),s.onmousemove=function(t){var e=t.clientX-s.offsetLeft,n=t.clientY-s.offsetTop;null!=d&&(d.isSelected=!1),d=r,r.isSelected=!0,r.x=e,r.y=n,v(h)},void(s.onmouseup=function(){s.onmousemove=null,s.onmouseup=null,console.log(a)})}},v=function(t){o.clearRect(0,0,s.width,s.height),o.drawImage(t,0,0,t.width,t.height);for(var e=0;e<a.length;e++){var n=a[e],i=m[0];e<=68&&(i=m[1]),e>=a.length-2&&(i=m[2]),e>68?(u=3,o.font="12px blod",o.fillStyle="blue",o.fillText(e,n.x+8,n.y-6)):u=1.5,o.globalAlpha=.85,o.beginPath(),o.arc(n.x,n.y,u,0,2*Math.PI),n.isSelected?(o.strokeStyle=i,o.lineWidth=3,o.stroke()):(o.fillStyle=i,o.fill())}},e.next=4,l=t.photoId,p()({url:f+"photo/point_info",method:"get",params:{photo_id:l},withCredentials:!0});case 4:(n=e.sent).data.data.label_point_info?t.circles=JSON.parse(n.data.data.label_point_info):t.circles=JSON.parse(n.data.data.point_info),t.formDataCircles(),a=t.circles,i=t,r=t.fileUrl,s=document.createElement("canvas"),o=s.getContext("2d"),c=new Image,u=1.5,d=void 0,h=void 0,m=["#409EFF","white","green"],s.onmousedown=_,c.onload=function(t){s.width=this.width,s.height=this.height,v(h=this),i.$refs.container.appendChild(s)},c.src=r;case 20:case"end":return e.stop()}var l},e,t)}))()}}},D={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{ref:"container",staticClass:"wrapper"},[e("div",{staticClass:"btnBox"},[e("el-button",{attrs:{type:"primary"},on:{click:this.addPonit}},[this._v("更新")]),this._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:this.close}},[this._v("关闭")])],1)])},staticRenderFns:[]};var F=n("VU/8")($,D,!1,function(t){n("nYFF")},"data-v-0a618a64",null).exports,S={name:"Label",data:function(){return{answerData:[],qiniuUrl:x,showPointBox:!1}},methods:{handleClick:function(t,e){console.log(t,e)},next:function(){var t=this;return u()(l.a.mark(function e(){var n,a,i,r;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!0,a={},t.answerData.forEach(function(t,e){a[t.info.key]={},t.list.forEach(function(e,i){e.answer||(n=!1);var r=e.item.id.toString();a[t.info.key][r]=e.answer})}),n){e.next=6;break}return t.$message.error("请将所有项目选择完，不能有不选的"),e.abrupt("return");case 6:return i={user_id:t.$route.query.user_id,photo_id:t.$route.query.id,base_feature:a},console.log(i),e.next=10,_(i);case 10:return e.next=12,h();case 12:r=e.sent,r.data.data.rows[0]||t.$message({message:"没有更多了",type:"warning"});case 16:case"end":return e.stop()}},e,t)}))()},init:function(){var t=this;return u()(l.a.mark(function e(){var n,a,i,r;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m();case 2:for(i in n=e.sent,a=[],n.data.data){for(r in n.data.data[i].list)n.data.data[i].list[r].answer="";a.push(n.data.data[i])}console.log(a),t.answerData=a;case 7:case"end":return e.stop()}},e,t)}))()}},components:{NosePoit:F},mounted:function(){this.init()}},q={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("div",{staticClass:"photo-box"},[n("div",{staticClass:"img",style:{backgroundImage:"url("+t.qiniuUrl(t.$route.query.file_url)+")"},on:{click:function(e){t.showPointBox=!0}}})]),t._v(" "),n("div",{staticClass:"label-box"},[t._l(t.answerData,function(e){return n("div",[n("div",[n("span",{staticClass:"group-name"},[t._v(t._s(e.info.name))]),t._v(" "),t._l(e.list,function(e){return n("div",{staticClass:"feature-box"},[n("div",{staticClass:"feature-name"},[t._v(t._s(e.item.name))]),t._v(" "),n("div",{staticClass:"feature-list"},t._l(e.answer_list,function(a,i){return n("el-radio",{key:i,attrs:{label:a.id},model:{value:e.answer,callback:function(n){t.$set(e,"answer",n)},expression:"feature.answer"}},[t._v(t._s(a.name))])}))])})],2)])}),t._v(" "),n("div",{staticClass:"feature-box"},[n("el-button",{attrs:{type:"primary"},on:{click:t.next}},[t._v("下一个")])],1)],2),t._v(" "),t.showPointBox?n("div",{staticClass:"point-box"},[n("nose-poit",{attrs:{fileUrl:t.qiniuUrl(t.$route.query.file_url),photoId:parseInt(t.$route.query.id)},on:{close:function(e){t.showPointBox=!1}}})],1):t._e()])},staticRenderFns:[]};var z=n("VU/8")(S,q,!1,function(t){n("ZxZl")},"data-v-bc9b45f8",null).exports,I=n("woOf"),P=n.n(I),L=n("fZjL"),B=n.n(L),R={name:"Label",data:function(){return{answerData:[],qiniuUrl:x,showPointBox:!1}},methods:{handleClick:function(t,e){console.log(t,e)},next:function(){var t=this;return u()(l.a.mark(function e(){var n,a,i;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!0,a={},t.answerData.forEach(function(t,e){a[t.info.key]={},t.list.forEach(function(e,i){e.answer||(n=!1);var r=e.item.id.toString();a[t.info.key][r]=e.answer})}),n){e.next=6;break}return t.$message.error("请将所有项目选择完，不能有不选的"),e.abrupt("return");case 6:return i={user_id:t.$route.query.user_id,photo_id:t.$route.query.id,base_feature:a},e.next=9,_(i);case 9:t.$message({message:"更改完成",type:"success"});case 10:case"end":return e.stop()}},e,t)}))()},init:function(){var t=this;return u()(l.a.mark(function e(){var n,a,i,r,s,o;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l=t.$route.query.id,p()({url:f+"feature/photo_feature",method:"get",params:{photo_id:l},withCredentials:!0});case 2:return n=e.sent,a={},B()(n.data.data.base_feature).forEach(function(t){a=P()({},a,n.data.data.base_feature[t])}),e.next=7,m();case 7:for(o in i=e.sent,r=[],s=function(t){var e=function(e){B()(a).forEach(function(n){i.data.data[t].list[e].item.id!==parseInt(n)||(i.data.data[t].list[e].answer=a[n])})};for(var n in i.data.data[t].list)e(n);r.push(i.data.data[t])},i.data.data)s(o);t.answerData=r;case 12:case"end":return e.stop()}var l},e,t)}))()}},mounted:function(){this.init()},components:{NosePoit:F}},N={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("div",{staticClass:"photo-box"},[n("div",{staticClass:"img",style:{backgroundImage:"url("+t.qiniuUrl(t.$route.query.file_url)+")"},on:{click:function(e){t.showPointBox=!0}}})]),t._v(" "),n("div",{staticClass:"label-box"},[t._l(t.answerData,function(e){return n("div",[n("div",[n("span",{staticClass:"group-name"},[t._v(t._s(e.info.name))]),t._v(" "),t._l(e.list,function(e){return n("div",{staticClass:"feature-box"},[n("div",{staticClass:"feature-name"},[t._v(t._s(e.item.name))]),t._v(" "),n("div",{staticClass:"feature-list"},t._l(e.answer_list,function(a,i){return n("el-radio",{key:i,attrs:{label:a.id},model:{value:e.answer,callback:function(n){t.$set(e,"answer",n)},expression:"feature.answer"}},[t._v(t._s(a.name))])}))])})],2)])}),t._v(" "),n("div",{staticClass:"feature-box"},[n("el-button",{attrs:{type:"primary"},on:{click:t.next}},[t._v("更新")])],1)],2),t._v(" "),t.showPointBox?n("div",{staticClass:"point-box"},[n("nose-poit",{attrs:{fileUrl:t.qiniuUrl(t.$route.query.file_url),photoId:parseInt(t.$route.query.id)},on:{close:function(e){t.showPointBox=!1}}})],1):t._e()])},staticRenderFns:[]};var T=n("VU/8")(R,N,!1,function(t){n("Z2un")},"data-v-0827a12e",null).exports,E={name:"Index",data:function(){return{treeData:[],defaultProps:{children:"children",label:"label"}}},mounted:function(){this.init()},methods:{delOpen:function(t){var e=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(u()(l.a.mark(function n(){return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,v(t);case 2:e.init(),e.$message({type:"success",message:"删除成功!"});case 4:case"end":return n.stop()}},n,e)}))).catch(function(){e.$message({type:"info",message:"已取消删除"})})},open:function(t){var e,n=this;this.$prompt("请输入名字","添加",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((e=u()(l.a.mark(function e(a){var i=a.value;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a=t,r=i,p()({url:f+"feature/feature_answer",method:"post",data:{feature_item_id:a,name:r},withCredentials:!0});case 2:n.init(),n.$message({type:"success",message:"添加成功!"});case 4:case"end":return e.stop()}var a,r},e,n)})),function(t){return e.apply(this,arguments)})).catch(function(){n.$message({type:"info",message:"取消输入"})})},openAddFeature:function(t){var e,n=this;this.$prompt("请输入名字","添加",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((e=u()(l.a.mark(function e(a){var i=a.value;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,addFeature(t,i);case 2:case"end":return e.stop()}},e,n)})),function(t){return e.apply(this,arguments)})).catch(function(){n.$message({type:"info",message:"取消输入"})})},renderContent:function(t,e){var n=this,a=e.node,i=e.data;e.store;return t("span",{class:"custom-tree-node"},[t("span",[a.label]),t("span",[2==a.level?t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(){2==a.level&&n.open(i.item.id)}}},["添加"]):null,3==a.level?t("el-button",{attrs:{size:"mini",type:"text"},on:{click:u()(l.a.mark(function t(){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.delOpen(i.id);case 1:case"end":return t.stop()}},t,n)}))}},["删除"]):null])])},handleNodeClick:function(t){console.log(t)},init:function(){var t=this;return u()(l.a.mark(function e(){var n,a,i,r,s,o;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m();case 2:for(i in n=e.sent,a=[],n.data.data){for(s in(r=n.data.data[i]).label=r.info.name,r.list){for(o in r.list[s].label=r.list[s].item.name,r.list[s].answer_list)r.list[s].answer_list[o].label=r.list[s].answer_list[o].name;r.list[s].children=r.list[s].answer_list}r.children=r.list,a.push(r)}console.log(a),t.treeData=a;case 7:case"end":return e.stop()}},e,t)}))()},handleClick:function(t){this.$router.push({path:"/label",query:{id:t.id}})}}},H={render:function(){var t=this.$createElement;return(this._self._c||t)("el-tree",{attrs:{data:this.treeData,props:this.defaultProps,accordion:"","render-content":this.renderContent},on:{"node-click":this.handleNodeClick}})},staticRenderFns:[]};var A=n("VU/8")(E,H,!1,function(t){n("OhVj")},"data-v-5afcaebc",null).exports,O={data:function(){return{imageUrl:"",originalUrl:"",width:"",height:"",originalFile:"",uploadTime:"",analyzeFaceTime:"",url:"",loading:!1}},methods:{uploadBase64:function(t){var e=this;return u()(l.a.mark(function n(){var a,i,r,s,o,c,u,d,p,f;return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a=e,i=new Date,r=t.split(","),s=r[0].match(/:(.*?);/)[1],o=s.length,c=parseInt(o+13),u=(u=t.substring(c)).replace(/^.*?,/,""),n.next=8,w();case 8:d=(d=n.sent).data.data.token,p="http://upload.qiniup.com/putb64/-1",(f=new XMLHttpRequest).onreadystatechange=function(){if(4==f.readyState){var t=new Date-i;a.uploadTime=t;var e="http://pc43w2wc6.bkt.clouddn.com/"+JSON.parse(f.responseText).hash;a.url=e,a.analyzeFace()}},f.open("POST",p,!0),f.setRequestHeader("Content-Type","application/octet-stream"),f.setRequestHeader("Authorization","UpToken "+d),f.send(u);case 17:case"end":return n.stop()}},n,e)}))()},upload:function(t){var e=this;return u()(l.a.mark(function n(){var a,i,r,s,o,c,u,d;return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t){n.next=2;break}return n.abrupt("return");case 2:return e.loading=!0,e.imageUrl=URL.createObjectURL(t),e.getWH(),n.prev=5,a=new Date,n.next=9,w();case 9:return i=(i=n.sent).data.data.token,(r=new FormData).append("token",i),r.append("file",t),n.next=16,l=r,p()({url:"http://upload.qiniup.com",method:"post",data:l});case 16:return s=n.sent,o=s.data.hash,c="http://pc43w2wc6.bkt.clouddn.com/"+o,e.url=c,u=new Date,d=u-a,e.uploadTime=d,n.next=25,e.analyzeFace();case 25:n.next=31;break;case 27:n.prev=27,n.t0=n.catch(5),console.log(n.t0),e.loading=!1;case 31:case"end":return n.stop()}var l},n,e,[[5,27]])}))()},analyzeFace:function(){var t=this;return u()(l.a.mark(function e(){var n,a,i,r,s;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.url){e.next=3;break}return e.abrupt("return");case 3:return a=new Date,e.next=6,g(n);case 6:i=e.sent,r=new Date,s=r-a,t.analyzeFaceTime=s,t.loading=!1,t.drawPoint(i.data.data.faceInfo.landmark);case 12:case"end":return e.stop()}},e,t)}))()},getWH:function(){var t=this,e=new Image;e.onload=function(e){t.width=this.width,t.height=this.height},e.src=this.imageUrl},selectImg:function(t){var e=t.target.files[0];this.imageUrl=URL.createObjectURL(e),this.originalUrl=URL.createObjectURL(e),this.originalFile=e,this.getWH()},zoom:function(t){this.loading=!0;var e=this,n=document.createElement("canvas"),a=n.getContext("2d"),i=new Image;i.onload=function(i){var r=this.width/t,s=this.height/r;n.width=t,n.height=s,a.drawImage(this,0,0,t,s);var o=n.toDataURL("image/png");e.imageUrl=o,e.getWH(),e.uploadBase64(o)},i.src=this.originalUrl},drawPoint:function(t){var e=this,n=document.createElement("canvas"),a=n.getContext("2d"),i=new Image;i.onload=function(i){n.width=this.width,n.height=this.height,a.drawImage(this,0,0,this.width,this.height),t.forEach(function(t,e){var n=t[0],i=t[1],r=2*Math.PI;a.beginPath(),a.fillStyle="#409EFF",a.arc(n,i,3,0,r),a.fill()});var r=n.toDataURL("image/png");e.imageUrl=r},i.src=this.imageUrl}}},M={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[n("div",{staticClass:"top"},[n("div",{staticClass:"imgBox"},[n("img",{attrs:{src:t.imageUrl,alt:""}})]),t._v(" "),n("div",{staticClass:"info"},[n("p",[t._v("当前宽度: "+t._s(this.width)+"px")]),t._v(" "),n("p",[t._v("当前高度: "+t._s(this.height)+"px")]),t._v(" "),n("p",[t._v("上传时间: "+t._s(this.uploadTime)+"ms")]),t._v(" "),n("p",[t._v("识别时间: "+t._s(this.analyzeFaceTime)+"ms")])])]),t._v(" "),n("div",{staticClass:"btnBox"},[n("input",{attrs:{name:"file",type:"file",accept:"image/*"},on:{change:t.selectImg}}),t._v(" "),n("el-row",[n("el-button",{attrs:{type:"primary"},on:{click:function(e){t.upload(t.originalFile)}}},[t._v("原图识别")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(e){t.zoom(1024)}}},[t._v("压缩1024识别")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(e){t.zoom(512)}}},[t._v("压缩512识别")])],1)],1)])},staticRenderFns:[]};var Z=n("VU/8")(O,M,!1,function(t){n("+c8h")},"data-v-7bd112ec",null).exports;a.default.use(s.a);var j=new s.a({routes:[{path:"/",redirect:"/index"},{path:"/index",name:"Index",component:k},{path:"/label",name:"Label",component:z},{path:"/update_label",name:"UpdateLabel",component:T},{path:"/feature",name:"Feature",component:A},{path:"/test",name:"TestAiLabelFace",component:Z},{path:"/nose_point",name:"NosePoint",component:F}]}),V=n("zL8q"),W=n.n(V);n("tvR6");a.default.config.productionTip=!1,a.default.use(W.a),new a.default({el:"#app",router:j,components:{App:r},template:"<App/>"})},NJb4:function(t,e){},OhVj:function(t,e){},QQxm:function(t,e){},Z2un:function(t,e){},ZxZl:function(t,e){},nYFF:function(t,e){},tvR6:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.b90be225eaabfa3b8890.js.map