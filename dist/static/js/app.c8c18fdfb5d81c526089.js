webpackJsonp([1],{"/r31":function(e,t){},"2Q/m":function(e,t){},"6jDp":function(e,t){},KUZH:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("7+uW"),i={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("el-container",{staticStyle:{height:"768px","box-sizing":"border-box",border:"1px solid #eee"}},[n("el-aside",{staticStyle:{"background-color":"rgb(238, 241, 246)"},attrs:{width:"200px"}},[n("el-menu",{attrs:{"default-openeds":["1","3"]}},[n("el-submenu",{attrs:{index:"1"}},[n("template",{slot:"title"},[n("i",{staticClass:"el-icon-message"}),e._v("导航一")]),e._v(" "),n("el-menu-item-group",[n("template",{slot:"title"},[e._v("分组一")]),e._v(" "),n("el-menu-item",{attrs:{index:"1-1"},on:{click:function(t){e.$router.push("feature")}}},[e._v("脸部特征管理")]),e._v(" "),n("el-menu-item",{attrs:{index:"1-2"},on:{click:function(t){e.$router.push("test")}}},[e._v("测试AI标注")]),e._v(" "),n("el-menu-item",{attrs:{index:"1-3"},on:{click:function(t){e.$router.push("index")}}},[e._v("手工标注")])],2),e._v(" "),n("el-submenu",{attrs:{index:"1-4"}},[n("template",{slot:"title"},[e._v("选项4")]),e._v(" "),n("el-menu-item",{attrs:{index:"1-4-1"}},[e._v("选项4-1")])],2)],2),e._v(" "),n("el-submenu",{attrs:{index:"2"}},[n("template",{slot:"title"},[n("i",{staticClass:"el-icon-menu"}),e._v("导航二")]),e._v(" "),n("el-menu-item-group",[n("template",{slot:"title"},[e._v("分组一")]),e._v(" "),n("el-menu-item",{attrs:{index:"2-1"}},[e._v("选项1")]),e._v(" "),n("el-menu-item",{attrs:{index:"2-2"}},[e._v("选项2")])],2),e._v(" "),n("el-menu-item-group",{attrs:{title:"分组2"}},[n("el-menu-item",{attrs:{index:"2-3"}},[e._v("选项3")])],1),e._v(" "),n("el-submenu",{attrs:{index:"2-4"}},[n("template",{slot:"title"},[e._v("选项4")]),e._v(" "),n("el-menu-item",{attrs:{index:"2-4-1"}},[e._v("选项4-1")])],2)],2),e._v(" "),n("el-submenu",{attrs:{index:"3"}},[n("template",{slot:"title"},[n("i",{staticClass:"el-icon-setting"}),e._v("导航三")]),e._v(" "),n("el-menu-item-group",[n("template",{slot:"title"},[e._v("分组一")]),e._v(" "),n("el-menu-item",{attrs:{index:"3-1"}},[e._v("选项1")]),e._v(" "),n("el-menu-item",{attrs:{index:"3-2"}},[e._v("选项2")])],2),e._v(" "),n("el-menu-item-group",{attrs:{title:"分组2"}},[n("el-menu-item",{attrs:{index:"3-3"}},[e._v("选项3")])],1),e._v(" "),n("el-submenu",{attrs:{index:"3-4"}},[n("template",{slot:"title"},[e._v("选项4")]),e._v(" "),n("el-menu-item",{attrs:{index:"3-4-1"}},[e._v("选项4-1")])],2)],2)],1)],1),e._v(" "),n("el-container",[n("el-header",{staticStyle:{"text-align":"right","font-size":"12px"}},[n("el-dropdown",[n("i",{staticClass:"el-icon-setting",staticStyle:{"margin-right":"15px"}}),e._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",[e._v("查看")]),e._v(" "),n("el-dropdown-item",[e._v("新增")]),e._v(" "),n("el-dropdown-item",[e._v("删除")])],1)],1),e._v(" "),n("span",[e._v("王小虎")])],1),e._v(" "),n("el-main",[n("router-view")],1)],1)],1)],1)},staticRenderFns:[]};var r=n("VU/8")({name:"App"},i,!1,function(e){n("NJb4")},null,null).exports,s=n("/ocq"),o=n("Xxa5"),l=n.n(o),u=n("exGp"),c=n.n(u),d=n("mtWM"),p=n.n(d),m="http://manage.sharezdm.cn/";function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15;return p()({url:m+"photo/list",method:"get",params:{page_num:t,page_size:n,is_label:e},withCredentials:!0})}function f(){return p()({url:m+"feature/list",method:"get",withCredentials:!0})}function v(e){return p()({url:m+"feature/feature_answer",method:"delete",data:{id:e},withCredentials:!0})}function g(e){return p()({url:"http://diff.sharezdm.cn/index/analyzefacepro",method:"post",data:{image_url:e}})}function _(){return p()({url:"http://diff.sharezdm.cn/index/getuploadtoken",method:"get"})}var w={name:"Index",data:function(){return{activeName:"first",labelData:[],notLabelData:[]}},mounted:function(){this.init()},methods:{init:function(){var e=this;return c()(l.a.mark(function t(){var n,a;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h();case 2:return n=t.sent,e.labelData=n.data.data.rows,t.next=6,h(1);case 6:a=t.sent,e.notLabelData=a.data.data.rows;case 8:case"end":return t.stop()}},t,e)}))()},handleClick:function(e){console.log(e),this.$router.push({path:"/label",query:{id:e.id,user_id:e.user_id,file_url:e.file_url}})}}},x={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[n("el-tab-pane",{attrs:{label:"未标注照片",name:"first"}},[n("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:e.labelData}},[n("el-table-column",{attrs:{label:"照片",width:"180"},scopedSlots:e._u([{key:"default",fn:function(e){return[n("div",{style:{backgroundImage:"url("+e.row.file_url+")",backgroundSize:"cover",width:"75px",height:"75px"}})]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"id",label:"照片id",width:"180"}}),e._v(" "),n("el-table-column",{attrs:{prop:"created_at",label:"上传时间",width:"180"}}),e._v(" "),n("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(n){e.handleClick(t.row)}}},[e._v("标注")])]}}])})],1)],1),e._v(" "),n("el-tab-pane",{attrs:{label:"已标注照片",name:"second"}},[n("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:e.notLabelData}},[n("el-table-column",{attrs:{label:"照片",width:"180"},scopedSlots:e._u([{key:"default",fn:function(e){return[n("div",{style:{backgroundImage:"url("+e.row.file_url+")",backgroundSize:"cover",width:"75px",height:"75px"}})]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"id",label:"照片id",width:"180"}}),e._v(" "),n("el-table-column",{attrs:{prop:"created_at",label:"上传时间",width:"180"}}),e._v(" "),n("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(n){e.handleClick(t.row)}}},[e._v("更改标注")])]}}])})],1)],1)],1)},staticRenderFns:[]};var b=n("VU/8")(w,x,!1,function(e){n("/r31")},"data-v-454d32ea",null).exports,y={name:"Label",data:function(){return{answerData:[]}},methods:{handleClick:function(e,t){console.log(e,t)},next:function(){var e=this;return c()(l.a.mark(function t(){var n,a,i,r,s;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=!0,a={},e.answerData.forEach(function(e,t){a[e.info.key]={},e.list.forEach(function(t,i){t.answer||(n=!1);var r=t.item.id.toString();a[e.info.key][r]=t.answer})}),n){t.next=6;break}return e.$message.error("请将所有项目选择完，不能有不选的"),t.abrupt("return");case 6:return i={user_id:e.$route.query.user_id,photo_id:e.$route.query.id,base_feature:a},console.log(i),t.next=10,o=i,p()({url:m+"feature/addphotofeature",method:"post",data:o,withCredentials:!0});case 10:return t.next=12,h();case 12:r=t.sent,(s=r.data.data.rows[0])||e.$message({message:"没有更多了",type:"warning"}),e.$router.push({path:"/label",query:{id:s.id,user_id:s.user_id,file_url:s.file_url}}),window.location.reload();case 18:case"end":return t.stop()}var o},t,e)}))()},init:function(){var e=this;return c()(l.a.mark(function t(){var n,a,i,r;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f();case 2:for(i in n=t.sent,a=[],n.data.data){for(r in n.data.data[i].list)n.data.data[i].list[r].answer="";a.push(n.data.data[i])}console.log(a),e.answerData=a;case 7:case"end":return t.stop()}},t,e)}))()}},mounted:function(){this.init()}},k={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("div",{staticClass:"photo-box"},[n("div",{staticClass:"img",style:{backgroundImage:"url("+e.$route.query.file_url+")"}})]),e._v(" "),n("div",{staticClass:"label-box"},[e._l(e.answerData,function(t){return n("div",[n("div",[n("span",{staticClass:"group-name"},[e._v(e._s(t.info.name))]),e._v(" "),e._l(t.list,function(t){return n("div",{staticClass:"feature-box"},[n("div",{staticClass:"feature-name"},[e._v(e._s(t.item.name))]),e._v(" "),n("div",{staticClass:"feature-list"},e._l(t.answer_list,function(a){return n("el-radio",{attrs:{label:a.id},model:{value:t.answer,callback:function(n){e.$set(t,"answer",n)},expression:"feature.answer"}},[e._v(e._s(a.name))])}))])})],2)])}),e._v(" "),n("div",{staticClass:"feature-box"},[n("el-button",{attrs:{type:"primary"},on:{click:e.next}},[e._v("下一个")])],1)],2)])},staticRenderFns:[]};var C=n("VU/8")(y,k,!1,function(e){n("6jDp")},"data-v-7a134770",null).exports,U={name:"Index",data:function(){return{treeData:[],defaultProps:{children:"children",label:"label"}}},mounted:function(){this.init()},methods:{delOpen:function(e){var t=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(c()(l.a.mark(function n(){return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,v(e);case 2:t.init(),t.$message({type:"success",message:"删除成功!"});case 4:case"end":return n.stop()}},n,t)}))).catch(function(){t.$message({type:"info",message:"已取消删除"})})},open:function(e){var t,n=this;this.$prompt("请输入名字","添加",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((t=c()(l.a.mark(function t(a){var i=a.value;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a=e,r=i,p()({url:m+"feature/feature_answer",method:"post",data:{feature_item_id:a,name:r},withCredentials:!0});case 2:n.init(),n.$message({type:"success",message:"添加成功!"});case 4:case"end":return t.stop()}var a,r},t,n)})),function(e){return t.apply(this,arguments)})).catch(function(){n.$message({type:"info",message:"取消输入"})})},openAddFeature:function(e){var t,n=this;this.$prompt("请输入名字","添加",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((t=c()(l.a.mark(function t(a){var i=a.value;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,addFeature(e,i);case 2:case"end":return t.stop()}},t,n)})),function(e){return t.apply(this,arguments)})).catch(function(){n.$message({type:"info",message:"取消输入"})})},renderContent:function(e,t){var n=this,a=t.node,i=t.data;t.store;return e("span",{class:"custom-tree-node"},[e("span",[a.label]),e("span",[2==a.level?e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(){2==a.level&&n.open(i.item.id)}}},["添加"]):null,3==a.level?e("el-button",{attrs:{size:"mini",type:"text"},on:{click:c()(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.delOpen(i.id);case 1:case"end":return e.stop()}},e,n)}))}},["删除"]):null])])},handleNodeClick:function(e){console.log(e)},init:function(){var e=this;return c()(l.a.mark(function t(){var n,a,i,r,s,o;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f();case 2:for(i in n=t.sent,a=[],n.data.data){for(s in(r=n.data.data[i]).label=r.info.name,r.list){for(o in r.list[s].label=r.list[s].item.name,r.list[s].answer_list)r.list[s].answer_list[o].label=r.list[s].answer_list[o].name;r.list[s].children=r.list[s].answer_list}r.children=r.list,a.push(r)}console.log(a),e.treeData=a;case 7:case"end":return t.stop()}},t,e)}))()},handleClick:function(e){this.$router.push({path:"/label",query:{id:e.id}})}}},z={render:function(){var e=this.$createElement;return(this._self._c||e)("el-tree",{attrs:{data:this.treeData,props:this.defaultProps,accordion:"","render-content":this.renderContent},on:{"node-click":this.handleNodeClick}})},staticRenderFns:[]};var F=n("VU/8")(U,z,!1,function(e){n("OhVj")},"data-v-5afcaebc",null).exports,D={data:function(){return{imageUrl:"",originalUrl:"",width:"",height:"",originalFile:"",uploadTime:"",analyzeFaceTime:"",url:"",loading:!1}},methods:{uploadBase64:function(e){var t=this;return c()(l.a.mark(function n(){var a,i,r,s,o,u,c,d,p,m;return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a=t,i=new Date,r=e.split(","),s=r[0].match(/:(.*?);/)[1],o=s.length,u=parseInt(o+13),c=(c=e.substring(u)).replace(/^.*?,/,""),n.next=8,_();case 8:d=(d=n.sent).data.data.token,p="http://upload.qiniup.com/putb64/-1",(m=new XMLHttpRequest).onreadystatechange=function(){if(4==m.readyState){var e=new Date-i;a.uploadTime=e;var t="http://pc43w2wc6.bkt.clouddn.com/"+JSON.parse(m.responseText).hash;a.url=t,a.analyzeFace()}},m.open("POST",p,!0),m.setRequestHeader("Content-Type","application/octet-stream"),m.setRequestHeader("Authorization","UpToken "+d),m.send(c);case 17:case"end":return n.stop()}},n,t)}))()},upload:function(e){var t=this;return c()(l.a.mark(function n(){var a,i,r,s,o,u,c,d;return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e){n.next=2;break}return n.abrupt("return");case 2:return t.loading=!0,t.imageUrl=URL.createObjectURL(e),t.getWH(),n.prev=5,a=new Date,n.next=9,_();case 9:return i=(i=n.sent).data.data.token,(r=new FormData).append("token",i),r.append("file",e),n.next=16,l=r,p()({url:"http://upload.qiniup.com",method:"post",data:l});case 16:return s=n.sent,o=s.data.hash,u="http://os6zbdtt2.bkt.clouddn.com/"+o,t.url=u,c=new Date,d=c-a,t.uploadTime=d,n.next=25,t.analyzeFace();case 25:n.next=31;break;case 27:n.prev=27,n.t0=n.catch(5),console.log(n.t0),t.loading=!1;case 31:case"end":return n.stop()}var l},n,t,[[5,27]])}))()},analyzeFace:function(){var e=this;return c()(l.a.mark(function t(){var n,a,i,r,s;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.url){t.next=3;break}return t.abrupt("return");case 3:return a=new Date,t.next=6,g(n);case 6:i=t.sent,r=new Date,s=r-a,e.analyzeFaceTime=s,e.loading=!1,e.drawPoint(i.data.data.faceInfo.landmark);case 12:case"end":return t.stop()}},t,e)}))()},getWH:function(){var e=this,t=new Image;t.onload=function(t){e.width=this.width,e.height=this.height},t.src=this.imageUrl},selectImg:function(e){var t=e.target.files[0];this.imageUrl=URL.createObjectURL(t),this.originalUrl=URL.createObjectURL(t),this.originalFile=t,this.getWH()},zoom:function(e){this.loading=!0;var t=this,n=document.createElement("canvas"),a=n.getContext("2d"),i=new Image;i.onload=function(i){var r=this.width/e,s=this.height/r;n.width=e,n.height=s,a.drawImage(this,0,0,e,s);var o=n.toDataURL("image/png");t.imageUrl=o,t.getWH(),t.uploadBase64(o)},i.src=this.originalUrl},drawPoint:function(e){var t=this,n=document.createElement("canvas"),a=n.getContext("2d"),i=new Image;i.onload=function(i){n.width=this.width,n.height=this.height,a.drawImage(this,0,0,this.width,this.height),e.forEach(function(e,t){var n=e[0],i=e[1],r=2*Math.PI;a.beginPath(),a.fillStyle="#409EFF",a.arc(n,i,3,0,r),a.fill()});var r=n.toDataURL("image/png");t.imageUrl=r},i.src=this.imageUrl}}},S={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[n("div",{staticClass:"top"},[n("div",{staticClass:"imgBox"},[n("img",{attrs:{src:e.imageUrl,alt:""}})]),e._v(" "),n("div",{staticClass:"info"},[n("p",[e._v("当前宽度: "+e._s(this.width)+"px")]),e._v(" "),n("p",[e._v("当前高度: "+e._s(this.height)+"px")]),e._v(" "),n("p",[e._v("上传时间: "+e._s(this.uploadTime)+"ms")]),e._v(" "),n("p",[e._v("识别时间: "+e._s(this.analyzeFaceTime)+"ms")])])]),e._v(" "),n("div",{staticClass:"btnBox"},[n("input",{attrs:{name:"file",type:"file",accept:"image/*"},on:{change:e.selectImg}}),e._v(" "),n("el-row",[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.upload(e.originalFile)}}},[e._v("原图识别")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.zoom(1024)}}},[e._v("压缩1024识别")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.zoom(512)}}},[e._v("压缩512识别")])],1)],1)])},staticRenderFns:[]};var $=n("VU/8")(D,S,!1,function(e){n("KUZH")},"data-v-86a4457e",null).exports,T={data:function(){return{imageUrl:"",originalUrl:"",width:"",height:"",originalFile:"",uploadTime:"",analyzeFaceTime:"",url:"",loading:!1}},mounted:function(){this.init()},methods:{init:function(){var e=[{x:10,y:10,isSelected:!1},{x:20,y:20}],t=this,n=document.createElement("canvas"),a=n.getContext("2d"),i=new Image,r=3,s=void 0,o=void 0;function l(t){a.clearRect(0,0,n.width,n.height),a.drawImage(t,0,0,t.width,t.height);for(var i=0;i<e.length;i++){var s=e[i];a.globalAlpha=.85,a.beginPath(),a.arc(s.x,s.y,r,0,2*Math.PI),s.isSelected?(a.strokeStyle="green",a.lineWidth=3,a.stroke()):(a.fillStyle="#409EFF",a.fill())}}n.onmousedown=function(t){for(var a=t.pageX-n.offsetLeft,i=t.pageY-n.offsetTop,u=e.length-1;u>=0;u--){var c=e[u],d=Math.sqrt(Math.pow(c.x-a,2)+Math.pow(c.y-i,2));if(d<=r)return null!=s&&(s.isSelected=!1),s=c,c.isSelected=!0,l(o),n.onmousemove=function(e){var t=e.clientX-n.offsetLeft,a=e.clientY-n.offsetTop;null!=s&&(s.isSelected=!1),s=c,c.isSelected=!0,c.x=t,c.y=a,l(o)},void(n.onmouseup=function(){n.onmousemove=null,n.onmouseup=null,console.log(e)})}},i.onload=function(e){n.width=this.width,n.height=this.height,l(o=this),t.$refs.container.appendChild(n)},i.src="http://os6zbdtt2.bkt.clouddn.com/Fmn93Hl1NzY2A9dP-FgBmrNzRxMa?nsukey=SoEyfKwopX0ZH%2FuoHP1Ua0s6xaa4DL6iW19AcUv6O%2Boenz4C25HDtZSIlkpHXh8NSvsi1fjAEGrCYrW%2BIpwRz%2FlYmzj53JVNt8iIgXERi2XX6VG5hWn8Mx75U%2F2qHQcvN9TJGT7y%2BXsjhLvjHAMP6vReveDWDdxKD9e46hk6rsuZUMU%2BznUPpAa8txpzGarQNoG2a%2FfZCvU4yg0LhZQBAg%3D%3D"}}},R={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{ref:"container",staticClass:"container"})},staticRenderFns:[]};var I=n("VU/8")(T,R,!1,function(e){n("2Q/m")},"data-v-70b05d57",null).exports;a.default.use(s.a);var L=new s.a({routes:[{path:"/",redirect:"/index"},{path:"/index",name:"Index",component:b},{path:"/label",name:"Label",component:C},{path:"/feature",name:"Feature",component:F},{path:"/test",name:"TestAiLabelFace",component:$},{path:"/nose_point",name:"NosePoint",component:I}]}),N=n("zL8q"),H=n.n(N);n("tvR6");a.default.config.productionTip=!1,a.default.use(H.a),new a.default({el:"#app",router:L,components:{App:r},template:"<App/>"})},NJb4:function(e,t){},OhVj:function(e,t){},tvR6:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.c8c18fdfb5d81c526089.js.map