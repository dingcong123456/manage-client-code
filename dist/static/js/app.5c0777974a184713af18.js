webpackJsonp([1],{"/r31":function(t,e){},"6jDp":function(t,e){},KUZH:function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("7+uW"),r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("el-container",{staticStyle:{height:"768px","box-sizing":"border-box",border:"1px solid #eee"}},[a("el-aside",{staticStyle:{"background-color":"rgb(238, 241, 246)"},attrs:{width:"200px"}},[a("el-menu",{attrs:{"default-openeds":["1","3"]}},[a("el-submenu",{attrs:{index:"1"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-message"}),t._v("导航一")]),t._v(" "),a("el-menu-item-group",[a("template",{slot:"title"},[t._v("分组一")]),t._v(" "),a("el-menu-item",{attrs:{index:"1-1"},on:{click:function(e){t.$router.push("feature")}}},[t._v("脸部特征管理")]),t._v(" "),a("el-menu-item",{attrs:{index:"1-2"},on:{click:function(e){t.$router.push("test")}}},[t._v("测试AI标注")]),t._v(" "),a("el-menu-item",{attrs:{index:"1-3"},on:{click:function(e){t.$router.push("index")}}},[t._v("手工标注")])],2),t._v(" "),a("el-submenu",{attrs:{index:"1-4"}},[a("template",{slot:"title"},[t._v("选项4")]),t._v(" "),a("el-menu-item",{attrs:{index:"1-4-1"}},[t._v("选项4-1")])],2)],2),t._v(" "),a("el-submenu",{attrs:{index:"2"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-menu"}),t._v("导航二")]),t._v(" "),a("el-menu-item-group",[a("template",{slot:"title"},[t._v("分组一")]),t._v(" "),a("el-menu-item",{attrs:{index:"2-1"}},[t._v("选项1")]),t._v(" "),a("el-menu-item",{attrs:{index:"2-2"}},[t._v("选项2")])],2),t._v(" "),a("el-menu-item-group",{attrs:{title:"分组2"}},[a("el-menu-item",{attrs:{index:"2-3"}},[t._v("选项3")])],1),t._v(" "),a("el-submenu",{attrs:{index:"2-4"}},[a("template",{slot:"title"},[t._v("选项4")]),t._v(" "),a("el-menu-item",{attrs:{index:"2-4-1"}},[t._v("选项4-1")])],2)],2),t._v(" "),a("el-submenu",{attrs:{index:"3"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-setting"}),t._v("导航三")]),t._v(" "),a("el-menu-item-group",[a("template",{slot:"title"},[t._v("分组一")]),t._v(" "),a("el-menu-item",{attrs:{index:"3-1"}},[t._v("选项1")]),t._v(" "),a("el-menu-item",{attrs:{index:"3-2"}},[t._v("选项2")])],2),t._v(" "),a("el-menu-item-group",{attrs:{title:"分组2"}},[a("el-menu-item",{attrs:{index:"3-3"}},[t._v("选项3")])],1),t._v(" "),a("el-submenu",{attrs:{index:"3-4"}},[a("template",{slot:"title"},[t._v("选项4")]),t._v(" "),a("el-menu-item",{attrs:{index:"3-4-1"}},[t._v("选项4-1")])],2)],2)],1)],1),t._v(" "),a("el-container",[a("el-header",{staticStyle:{"text-align":"right","font-size":"12px"}},[a("el-dropdown",[a("i",{staticClass:"el-icon-setting",staticStyle:{"margin-right":"15px"}}),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[t._v("查看")]),t._v(" "),a("el-dropdown-item",[t._v("新增")]),t._v(" "),a("el-dropdown-item",[t._v("删除")])],1)],1),t._v(" "),a("span",[t._v("王小虎")])],1),t._v(" "),a("el-main",[a("router-view")],1)],1)],1)],1)},staticRenderFns:[]};var i=a("VU/8")({name:"App"},r,!1,function(t){a("NJb4")},null,null).exports,s=a("/ocq"),l=a("Xxa5"),o=a.n(l),u=a("exGp"),c=a.n(u),d=a("mtWM"),p=a.n(d),m="http://manage.sharezdm.cn/";function h(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15;return p()({url:m+"photo/list",method:"get",params:{page_num:e,page_size:a,is_label:t},withCredentials:!0})}function f(){return p()({url:m+"feature/list",method:"get",withCredentials:!0})}function v(t){return p()({url:m+"feature/feature_answer",method:"delete",data:{id:t},withCredentials:!0})}function _(t){return p()({url:"http://diff.sharezdm.cn/index/analyzefacepro",method:"post",data:{image_url:t}})}function g(){return p()({url:"http://diff.sharezdm.cn/index/getuploadtoken",method:"get"})}var w={name:"Index",data:function(){return{activeName:"first",labelData:[],notLabelData:[]}},mounted:function(){this.init()},methods:{init:function(){var t=this;return c()(o.a.mark(function e(){var a,n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h();case 2:return a=e.sent,t.labelData=a.data.data.rows,e.next=6,h(1);case 6:n=e.sent,t.notLabelData=n.data.data.rows;case 8:case"end":return e.stop()}},e,t)}))()},handleClick:function(t){console.log(t),this.$router.push({path:"/label",query:{id:t.id,user_id:t.user_id,file_url:t.file_url}})}}},x={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"未标注照片",name:"first"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:t.labelData}},[a("el-table-column",{attrs:{label:"照片",width:"180"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("div",{style:{backgroundImage:"url("+t.row.file_url+")",backgroundSize:"cover",width:"75px",height:"75px"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"id",label:"照片id",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"created_at",label:"上传时间",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.handleClick(e.row)}}},[t._v("标注")])]}}])})],1)],1),t._v(" "),a("el-tab-pane",{attrs:{label:"已标注照片",name:"second"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:t.notLabelData}},[a("el-table-column",{attrs:{label:"照片",width:"180"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("div",{style:{backgroundImage:"url("+t.row.file_url+")",backgroundSize:"cover",width:"75px",height:"75px"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"id",label:"照片id",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"created_at",label:"上传时间",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.handleClick(e.row)}}},[t._v("更改标注")])]}}])})],1)],1)],1)},staticRenderFns:[]};var b=a("VU/8")(w,x,!1,function(t){a("/r31")},"data-v-454d32ea",null).exports,k={name:"Label",data:function(){return{answerData:[]}},methods:{handleClick:function(t,e){console.log(t,e)},next:function(){var t=this;return c()(o.a.mark(function e(){var a,n,r,i,s;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!0,n={},t.answerData.forEach(function(t,e){n[t.info.key]={},t.list.forEach(function(e,r){e.answer||(a=!1);var i=e.item.id.toString();n[t.info.key][i]=e.answer})}),a){e.next=6;break}return t.$message.error("请将所有项目选择完，不能有不选的"),e.abrupt("return");case 6:return r={user_id:t.$route.query.user_id,photo_id:t.$route.query.id,base_feature:n},console.log(r),e.next=10,l=r,p()({url:m+"feature/addphotofeature",method:"post",data:l,withCredentials:!0});case 10:return e.next=12,h();case 12:i=e.sent,(s=i.data.data.rows[0])||t.$message({message:"没有更多了",type:"warning"}),t.$router.push({path:"/label",query:{id:s.id,user_id:s.user_id,file_url:s.file_url}}),window.location.reload();case 18:case"end":return e.stop()}var l},e,t)}))()},init:function(){var t=this;return c()(o.a.mark(function e(){var a,n,r,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:for(r in a=e.sent,n=[],a.data.data){for(i in a.data.data[r].list)a.data.data[r].list[i].answer="";n.push(a.data.data[r])}console.log(n),t.answerData=n;case 7:case"end":return e.stop()}},e,t)}))()}},mounted:function(){this.init()}},y={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticClass:"photo-box"},[a("div",{staticClass:"img",style:{backgroundImage:"url("+t.$route.query.file_url+")"}})]),t._v(" "),a("div",{staticClass:"label-box"},[t._l(t.answerData,function(e){return a("div",[a("div",[a("span",{staticClass:"group-name"},[t._v(t._s(e.info.name))]),t._v(" "),t._l(e.list,function(e){return a("div",{staticClass:"feature-box"},[a("div",{staticClass:"feature-name"},[t._v(t._s(e.item.name))]),t._v(" "),a("div",{staticClass:"feature-list"},t._l(e.answer_list,function(n){return a("el-radio",{attrs:{label:n.id},model:{value:e.answer,callback:function(a){t.$set(e,"answer",a)},expression:"feature.answer"}},[t._v(t._s(n.name))])}))])})],2)])}),t._v(" "),a("div",{staticClass:"feature-box"},[a("el-button",{attrs:{type:"primary"},on:{click:t.next}},[t._v("下一个")])],1)],2)])},staticRenderFns:[]};var C=a("VU/8")(k,y,!1,function(t){a("6jDp")},"data-v-7a134770",null).exports,U={name:"Index",data:function(){return{treeData:[],defaultProps:{children:"children",label:"label"}}},mounted:function(){this.init()},methods:{delOpen:function(t){var e=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(c()(o.a.mark(function a(){return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,v(t);case 2:e.init(),e.$message({type:"success",message:"删除成功!"});case 4:case"end":return a.stop()}},a,e)}))).catch(function(){e.$message({type:"info",message:"已取消删除"})})},open:function(t){var e,a=this;this.$prompt("请输入名字","添加",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((e=c()(o.a.mark(function e(n){var r=n.value;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n=t,i=r,p()({url:m+"feature/feature_answer",method:"post",data:{feature_item_id:n,name:i},withCredentials:!0});case 2:a.init(),a.$message({type:"success",message:"添加成功!"});case 4:case"end":return e.stop()}var n,i},e,a)})),function(t){return e.apply(this,arguments)})).catch(function(){a.$message({type:"info",message:"取消输入"})})},openAddFeature:function(t){var e,a=this;this.$prompt("请输入名字","添加",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((e=c()(o.a.mark(function e(n){var r=n.value;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,addFeature(t,r);case 2:case"end":return e.stop()}},e,a)})),function(t){return e.apply(this,arguments)})).catch(function(){a.$message({type:"info",message:"取消输入"})})},renderContent:function(t,e){var a=this,n=e.node,r=e.data;e.store;return t("span",{class:"custom-tree-node"},[t("span",[n.label]),t("span",[2==n.level?t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(){2==n.level&&a.open(r.item.id)}}},["添加"]):null,3==n.level?t("el-button",{attrs:{size:"mini",type:"text"},on:{click:c()(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a.delOpen(r.id);case 1:case"end":return t.stop()}},t,a)}))}},["删除"]):null])])},handleNodeClick:function(t){console.log(t)},init:function(){var t=this;return c()(o.a.mark(function e(){var a,n,r,i,s,l;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:for(r in a=e.sent,n=[],a.data.data){for(s in(i=a.data.data[r]).label=i.info.name,i.list){for(l in i.list[s].label=i.list[s].item.name,i.list[s].answer_list)i.list[s].answer_list[l].label=i.list[s].answer_list[l].name;i.list[s].children=i.list[s].answer_list}i.children=i.list,n.push(i)}console.log(n),t.treeData=n;case 7:case"end":return e.stop()}},e,t)}))()},handleClick:function(t){this.$router.push({path:"/label",query:{id:t.id}})}}},z={render:function(){var t=this.$createElement;return(this._self._c||t)("el-tree",{attrs:{data:this.treeData,props:this.defaultProps,accordion:"","render-content":this.renderContent},on:{"node-click":this.handleNodeClick}})},staticRenderFns:[]};var $=a("VU/8")(U,z,!1,function(t){a("OhVj")},"data-v-5afcaebc",null).exports,D={data:function(){return{imageUrl:"",originalUrl:"",width:"",height:"",originalFile:"",uploadTime:"",analyzeFaceTime:"",url:"",loading:!1}},methods:{uploadBase64:function(t){var e=this;return c()(o.a.mark(function a(){var n,r,i,s,l,u,c,d,p,m;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n=e,r=new Date,i=t.split(","),s=i[0].match(/:(.*?);/)[1],l=s.length,u=parseInt(l+13),c=(c=t.substring(u)).replace(/^.*?,/,""),a.next=8,g();case 8:d=(d=a.sent).data.data.token,p="http://upload.qiniup.com/putb64/-1",(m=new XMLHttpRequest).onreadystatechange=function(){if(4==m.readyState){var t=new Date-r;n.uploadTime=t;var e="http://pc43w2wc6.bkt.clouddn.com/"+JSON.parse(m.responseText).hash;n.url=e,n.analyzeFace()}},m.open("POST",p,!0),m.setRequestHeader("Content-Type","application/octet-stream"),m.setRequestHeader("Authorization","UpToken "+d),m.send(c);case 17:case"end":return a.stop()}},a,e)}))()},upload:function(t){var e=this;return c()(o.a.mark(function a(){var n,r,i,s,l,u,c,d;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(t){a.next=2;break}return a.abrupt("return");case 2:return e.loading=!0,e.imageUrl=URL.createObjectURL(t),e.getWH(),a.prev=5,n=new Date,a.next=9,g();case 9:return r=(r=a.sent).data.data.token,(i=new FormData).append("token",r),i.append("file",t),a.next=16,o=i,p()({url:"http://upload.qiniup.com",method:"post",data:o});case 16:return s=a.sent,l=s.data.hash,u="http://os6zbdtt2.bkt.clouddn.com/"+l,e.url=u,c=new Date,d=c-n,e.uploadTime=d,a.next=25,e.analyzeFace();case 25:a.next=31;break;case 27:a.prev=27,a.t0=a.catch(5),console.log(a.t0),e.loading=!1;case 31:case"end":return a.stop()}var o},a,e,[[5,27]])}))()},analyzeFace:function(){var t=this;return c()(o.a.mark(function e(){var a,n,r,i,s;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.url){e.next=3;break}return e.abrupt("return");case 3:return n=new Date,e.next=6,_(a);case 6:r=e.sent,i=new Date,s=i-n,t.analyzeFaceTime=s,t.loading=!1,t.drawPoint(r.data.data.faceInfo.landmark);case 12:case"end":return e.stop()}},e,t)}))()},getWH:function(){var t=this,e=new Image;e.onload=function(e){t.width=this.width,t.height=this.height},e.src=this.imageUrl},selectImg:function(t){var e=t.target.files[0];this.imageUrl=URL.createObjectURL(e),this.originalUrl=URL.createObjectURL(e),this.originalFile=e,this.getWH()},zoom:function(t){this.loading=!0;var e=this,a=document.createElement("canvas"),n=a.getContext("2d"),r=new Image;r.onload=function(r){var i=this.width/t,s=this.height/i;a.width=t,a.height=s,n.drawImage(this,0,0,t,s);var l=a.toDataURL("image/png");e.imageUrl=l,e.getWH(),e.uploadBase64(l)},r.src=this.originalUrl},drawPoint:function(t){var e=this,a=document.createElement("canvas"),n=a.getContext("2d"),r=new Image;r.onload=function(r){a.width=this.width,a.height=this.height,n.drawImage(this,0,0,this.width,this.height),t.forEach(function(t,e){var a=t[0],r=t[1],i=2*Math.PI;n.beginPath(),n.fillStyle="#409EFF",n.arc(a,r,3,0,i),n.fill()});var i=a.toDataURL("image/png");e.imageUrl=i},r.src=this.imageUrl}}},F={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[a("div",{staticClass:"top"},[a("div",{staticClass:"imgBox"},[a("img",{attrs:{src:t.imageUrl,alt:""}})]),t._v(" "),a("div",{staticClass:"info"},[a("p",[t._v("当前宽度: "+t._s(this.width)+"px")]),t._v(" "),a("p",[t._v("当前高度: "+t._s(this.height)+"px")]),t._v(" "),a("p",[t._v("上传时间: "+t._s(this.uploadTime)+"ms")]),t._v(" "),a("p",[t._v("识别时间: "+t._s(this.analyzeFaceTime)+"ms")])])]),t._v(" "),a("div",{staticClass:"btnBox"},[a("input",{attrs:{name:"file",type:"file",accept:"image/*"},on:{change:t.selectImg}}),t._v(" "),a("el-row",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.upload(t.originalFile)}}},[t._v("原图识别")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.zoom(1024)}}},[t._v("压缩1024识别")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.zoom(512)}}},[t._v("压缩512识别")])],1)],1)])},staticRenderFns:[]};var T=a("VU/8")(D,F,!1,function(t){a("KUZH")},"data-v-86a4457e",null).exports;n.default.use(s.a);var R=new s.a({routes:[{path:"/",redirect:"/index"},{path:"/index",name:"Index",component:b},{path:"/label",name:"Label",component:C},{path:"/feature",name:"Feature",component:$},{path:"/test",name:"TestAiLabelFace",component:T}]}),I=a("zL8q"),S=a.n(I);a("tvR6");n.default.config.productionTip=!1,n.default.use(S.a),new n.default({el:"#app",router:R,components:{App:i},template:"<App/>"})},NJb4:function(t,e){},OhVj:function(t,e){},tvR6:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.5c0777974a184713af18.js.map